import { getCustomStaticPath } from '@/utils/getCustomStaticPath';

export const meta = {
  title: 'Migrate from v5 to v6',
  description: 'Learn more about the migration steps to upgrade Auth APIs for Amplify JavaScript v5 to v6',
  platforms: ['angular', 'javascript', 'nextjs', 'react', 'vue']
};

export const getStaticPaths = async () => {
  return getCustomStaticPath(meta.platforms);
};

export function getStaticProps(context) {
  return {
    props: {
      platform: context.params.platform,
      meta
    }
  };
}

## Auth.signUp

```diff
-  import { Auth } from 'aws-amplify';
+  import { signUp } from 'aws-amplify/auth';

-  Auth.signUp: (params: string | SignUpParams,  ...restOfAttrs: string[]) => Promise<ISignUpResult>;
+  signUp: (input: SignUpInput) => Promise<SignUpOutput>;
```

<Accordion title='Input' headingLevel='3'>
  <Columns columns={2}>
    <div>
      **V5**
      
      ```
      // Standard
      params: SignUpParams {
        username: string;
        password: string;
        attributes?: object;
        validationData?: {
          [key: string]: string;
        }
        clientMetadata?: { [key: string]: string; };
        autoSignIn?: {
          enabled: boolean;
          clientMetaData?: { [key: string]: string; };
          validationData?: {
            [key: string]: string;
          }
        };
      }

      // Legacy
      username: string
      password: string
      email: string
      phone_number: string
      ```

    </div>
    <div>
      **V6**
      
      ```
      input: SignUpInput {
        username: string;
        password: string;
        options?: {
          userAttributes?: { [key: string]?: string; }
          validationData?: { [key: string]: string; };
          clientMetadata?: { [key: string]: string; };
          autoSignIn?: boolean | {
            authFlowType?:
              | 'USER_SRP_AUTH'
              | 'CUSTOM_WITH_SRP'
              | 'CUSTOM_WITHOUT_SRP'
              | 'USER_PASSWORD_AUTH';
            clientMetadata?: { [key: string]: string; };
          };
        };
      }
      ```

    </div>
  </Columns>
</Accordion>

<Accordion title='Output' headingLevel='3'>
  <Columns columns={2}>
    <div>
      **V5**
      
      ```
      ISignUpResult {
        user: CognitoUser;
        userConfirmed: boolean;
        userSub: string;
        codeDeliveryDetails: {
          AttributeName: string;
          DeliveryMedium: string;
          Destination: string;
        };
      }
      ```

    </div>
    <div>
      **V6**
      
      ```
      SignUpOutput {
        isSignUpComplete: boolean;
        userId?: string;
        nextStep: {
          signUpStep:
            | 'DONE'
            | 'CONFIRM_SIGN_UP'
            | 'COMPLETE_AUTO_SIGN_IN',
          codeDeliveryDetails: { // Not included when signUpStep is 'DONE'
            destination?: string;
            deliveryMedium?: 
              | 'EMAIL'
              | 'SMS'
              | 'PHONE'
              | 'UNKNOWN';
            attributeName?: UserAttributeKey;
          }
        };
      }
      ```
    
    </div>
  </Columns>
</Accordion>

### Example 1 (Standard)

<Columns columns={2}>
  <div>
    **V5**
    
    ```
    import { Auth } from 'aws-amplify';

    const handleSignUp = async ({
      username,
      password,
      email,
      phone_number,
      validationData
    }) => {
        const { user } = await Auth.signUp({
          username,
          password,
          attributes: {
            email,
            phone_number
          },
          validationData
        });
    }
    ```

    </div>
    <div>
      **V6**

      ```
      import { signUp } from 'aws-amplify/auth';

      const handleSignUp = async ({
        username,
        password,
        email,
        phone_number,
        validationData
      }) => {
        const {
          isSignUpComplete,
          userId,
          nextStep
        } = await signUp({
          username,
          password,
          options: {
            userAttributes: {
              email,
              phone_number
            },
            validationData
          }
        });
      }
      ```

    </div>

</Columns>

### Example 2 (Auto Sign-in)

NOTE: autoSignIn is no longer triggered automatically in v6

<Columns columns={2}>
  <div>
    **V5**
    
    ```
    import { Auth, Hub } from 'aws-amplify';

    // 1. Add listener for autoSignIn event
    Hub.listen('auth', ({ payload }) => {
      const { event } = payload;
      if (event === 'autoSignIn') {
        const confirmedUser = payload.data;
      } else if (event === 'autoSignIn_failure') {
        // redirect to sign in page
      }
    });

    // 2. Sign Up with autoSignIn enabled
    const handleSignUp = async ({
      username,
      password,
      email,
      phone_number,
      validationData
    }) => {
      const { user } = await Auth.signUp({
        username,
        password,
        attributes: {
          email,
          phone_number
        },
        validationData,
        autoSignIn: {
          enabled: true
        }
      });
    }

    // 3. Confirm Sign Up - this will trigger autoSignIn
    const handleConfirmSignUp = async ({
      username,
      confirmationCode
    }) {
      await Auth.confirmSignUp(username, confirmationCode);
    }

    ```

  </div>
  <div>
    **V6**
    
    ```
    import {
      autoSignIn,
      confirmSignUp,
      signUp
    } from 'aws-amplify/auth';

    // 1. Sign Up with autoSignIn enabled
    const handleSignUp = async ({
      username,
      password,
      email,
      phone_number,
      validationData
    }) => {
      const {
        isSignUpComplete,
        userId,
        nextStep
      } = await signUp({
        username,
        password,
        options: {
          userAttributes: {
            email,
            phone_number
          },
          validationData
        },
        autoSignIn: true
      });
    }

    // 2. Confirm Sign Up
    const handleConfirmSignUp = async ({
      username,
      confirmationCode
    }) => {
      const {
        isSignUpComplete,
        userId,
        nextStep
      } = await confirmSignUp({
        username,
        confirmationCode
      });

      // 3. Trigger autoSignIn event - will not be triggered automatically
      const { isSignedIn } = await autoSignIn();
    }
    ```

  </div>
</Columns>

### Example 3 (Legacy)

<Columns columns={2}>
  <div>
    **V5**
    
    ```
    import { Auth } from 'aws-amplify';

    const handleSignUp = async ({
      username,
      password,
      email,
      phone_number,
      validationData
    }) => {
      const { user } = await Auth.signUp(
        username,
        password,
        email,
        phone_number
      );
    }
    ```

  </div>
  <div>
    **V6**
    
    ```
    import { signUp } from 'aws-amplify/auth';

    const handleSignUp = async ({
      username,
      password,
      email,
      phone_number,
      validationData
    }) => {
      const {
        isSignUpComplete,
        userId,
        nextStep
      } = await signUp({
        username,
        password,
        options: {
          userAttributes: {
            email,
            phone_number
          }
        }
      });
    }
    ```

  </div>
</Columns>

## Auth.confirmSignUp

```diff
-  import { Auth } from 'aws-amplify';
+  import { confirmSignUp } from 'aws-amplify/auth';

-  Auth.confirmSignUp: (username: string, code: string, options?: ConfirmSignUpOptions) => Promise<any>;
+  confirmSignUp: (input: ConfirmSignUpInput) => Promise<ConfirmSignUpOutput>;
```

<Accordion title='Input' headingLevel='3'>
  <Columns columns={2}>
    <div>
      **V5**
      
      ```
      username: string
      code: string
      options?: ConfirmSignUpOptions {
          forceAliasCreation?: boolean;
          clientMetadata?: { [key: string]: string; };
      }
      ```

    </div>
    <div>
      **V6**
      
      ```
      input: ConfirmSignUpInput = {
          username: string;
          confirmationCode: string;
          options?: {
              clientMetadata?: { [key: string]: string; };
              forceAliasCreation?: boolean;
          };
      }
      ```

    </div>
  </Columns>
</Accordion>

<Accordion title='Output' headingLevel='3'>
  <Columns columns={2}>
    <div>
      **V5**
      
      ```
      'SUCCESS'
      ```

    </div>
    <div>
      **V6**
      
      ```
      type ConfirmSignUpOutput = {
          isSignUpComplete: boolean;
          userId?: string | undefined;
          nextStep: {
              signUpStep:
                  | 'DONE'
                  | 'CONFIRM_SIGN_UP'
                  | 'COMPLETE_AUTO_SIGN_IN',
              codeDeliveryDetails: { // Not included when signUpStep is 'DONE'
                  destination?: string;
                  deliveryMedium?: 
                    | 'EMAIL'
                    | 'SMS'
                    | 'PHONE'
                    | 'UNKNOWN';
                  attributeName?: UserAttributeKey;
              }
          };
      }
      ```
    
    </div>
  </Columns>
</Accordion>

### Example 1 (Standard)

<Columns columns={2}>
  <div>
    **V5**
    
    ```
    import { Auth } from 'aws-amplify';

    const handleConfirmSignUp = async ({
      username,
      confirmationCode
    }) {
      await Auth.confirmSignUp(
        username,
        confirmationCode
      );
    }
    ```

  </div>
  <div>
    **V6**
    
    ```
    import { confirmSignUp } from 'aws-amplify/auth';

    const handleConfirmSignUp = async ({
      username,
      confirmationCode
    }) {
      const {
        isSignUpComplete,
        userId,
        nextStep
      } = await confirmSignUp({
        username,
        confirmationCode
      });
    }
    ```

  </div>
</Columns>

### Example 2 (Force Alias Creation - defaults to true)

Note that forceAliasCreation defaulted to `true` in v5 but is left `undefined` by default in v6

<Columns columns={2}>
  <div>
    **V5**
    
    ```
    import { Auth } from 'aws-amplify';

    const handleConfirmSignUp = async ({
      username,
      confirmationCode
    }) {
      await Auth.confirmSignUp(
        username,
        confirmationCode,
        options: {
          // default true
          forceAliasCreation: false
        }
      );
    }
    ```

  </div>
  <div>
    **V6**
    
    ```
    import { confirmSignUp } from 'aws-amplify/auth';

    const handleConfirmSignUp = async ({
      username,
      confirmationCode
    }) {
      const {
        isSignUpComplete,
        userId,
        nextStep
      } = await confirmSignUp({
        username,
        confirmationCode,
        options: {
          // default falsy (undefined)
          forceAliasCreation: true
        }
      });
    }
    ```

  </div>
</Columns>

## Auth.resendSignUp

```diff
-  import { Auth } from 'aws-amplify';
+  import { resendSignUpCode } from 'aws-amplify/auth';

-  Auth.resendSignUp: (username: string, clientMetadata?: ClientMetaData) => Promise<any>;
+  resendSignUpCode: (input: ResendSignUpCodeInput) => Promise<ResendSignUpCodeOutput>;
```

<Accordion title='Input' headingLevel='3'>
  <Columns columns={2}>
    <div>
      **V5**
      
      ```
      username: string
      clientMetadata?: ClientMetaData {
        [key: string]: string;
      }
      ```

    </div>
    <div>
      **V6**
      
      ```
      input: ResendSignUpCodeInput {
          username: string;
          options?: {
              clientMetadata?: { [key: string]: string; };
          };
      }
      ```
    </div>
  </Columns>
</Accordion>

<Accordion title='Output' headingLevel='3'>
  <Columns columns={2}>
    <div>
      **V5**
      
      ```
      {
        CodeDeliveryDetails: {
            AttributeName: string,
            DeliveryMedium: string,
            Destination: string
        }
      }
      ```
    
    </div>
    <div>
      **V6**
      
      ```
      ResendSignUpCodeOutput {
          destination?: string;
          deliveryMedium?: 
            | 'EMAIL'
            | 'SMS'
            | 'PHONE'
            | 'UNKNOWN';
          attributeName?: AuthVerifiableAttributeKey;
      }
      ```
    </div>
  </Columns>
</Accordion>

### Example

<Columns columns={2}>
  <div>
    **V5**
    
    ```
    import { Auth } from 'aws-amplify';

    const handleResendCode = async ({ username }) => {
      await Auth.resendSignUp(username);
    }
    ```

  </div>
  <div>
    **V6**
    
    ```
    import { resendSignUpCode } from 'aws-amplify/auth';

    const handleResendCode = async ({ username }) => {
      await resendSignUpCode({ username });
    }
    ```

  </div>
</Columns>

## Auth.signIn

```diff
-  import { Auth } from 'aws-amplify';
+  import { signIn } from 'aws-amplify/auth';

-  Auth.signIn: (usernameOrSignInOpts: string | SignInOpts, pw?: string, clientMetadata?: ClientMetaData) => Promise<CognitoUser | any>;
+  signIn: (input: SignInInput) => Promise<SignInOutput>;
```

<Accordion title='Input' headingLevel='3'>
  <Columns columns={2}>
    <div>
      **V5**
      
      ```
      // Standard
      usernameOrSignInOpts: SignInOpts {
        username: string;
        password: string;
        validationData?: {
          [key: string]: any;
        };
      }
      pw?: undefined
      clientMetadata?: ClientMetaData {
        [key: string]: string;
      }

      // Legacy
      usernameOrSignInOpts: string
      pw?: string
      clientMetadata?: ClientMetaData {
        [key: string]: string;
      }
      ```

    </div>
    <div>
      **V6**
      
      ```
      input: SignInInput {
        username: string;
        password?: string;
        options?: {
          authFlowType?:
            | 'USER_SRP_AUTH'
            | 'CUSTOM_WITH_SRP'
            | 'CUSTOM_WITHOUT_SRP'
            | 'USER_PASSWORD_AUTH';
          clientMetadata?: ClientMetaData {
            [key: string]: string;
          }
        };
      }
      ```
    </div>
  </Columns>
</Accordion>

<Accordion title='Output' headingLevel='3'>
  <Columns columns={2}>
    <div>
      **V5**
      
      ```
      CognitoUser {
        challengeName?: string;
        challengeParam?: string;
        username: string;
        signInUserSession: {
          idToken: string;
          refreshToken: string;
          accessToken: string;
          clockDrift: number;
        } | null;
        authenticationFlowType: string;
      }
      ```

    </div>
    <div>
      **V6**
      
      ```
      type SignInOutput = {
        isSignedIn: boolean;
        nextStep: // See Example 2 for more details on nextStep types
          | ContinueSignInWithMFASelection
          | ContinueSignInWithTOTPSetup
          | ConfirmSignInWithSMSCode
          | ConfirmSignInWithTOTPCode
          | ConfirmSignInWithCustomChallenge
          | ConfirmSignInWithNewPasswordRequired<UserAttributeKey>
          | ConfirmSignUpStep
          | ResetPasswordStep
          | DoneSignInStep;
      }
      ```

    </div>
  </Columns>
</Accordion>

### Example 1 (Standard)

Note that signIn no longer accepts validationData in v6

<Columns columns={2}>
  <div>
    **V5**
    
    ```
    import { Auth } from 'aws-amplify';

    const handleSignIn = async ({
      username,
      password,
      validationData
    }) => {
      const user = await Auth.signIn({
        username,
        password,
        validationData
      });
    }
    ```

  </div>
  <div>
    **V6**
    
    ```
    import { signIn } from 'aws-amplify/auth';

    const handleSignIn = async ({
      username,
      password
    }) => {
      const {
        isSignIn,
        nextStep
      } = await signIn({ username, password });
    }
    ```

  </div>
</Columns>

### Example 2 (Confirmation Required)

NOTE: signIn no longer accepts validationData in v6

<Columns columns={2}>
  <div>
    **V5**
    
    ```
    import { Auth } from 'aws-amplify';

    const handleSignIn = async ({
      username,
      password,
      validationData
    }) => {
      const user = await Auth.signIn({
        username,
        password
      });

      if (user.challengeName) {
        switch(user.challengeName) {
          case 'SMS_MFA':
          case 'SOFTWARE_TOKEN':
            const confirmedUser = await Auth.confirmSignIn(
              user,
              'code',
              user.challengeName
            );
            break;
          case 'CUSTOM_CHALLENGE':
            const confirmedUser = await Auth.confirmSignIn(
              user,
              'answer',
              user.challengeName
            );
            break;
          case 'MFA_SETUP':
            const secretCode = await Auth.setupTOTP(user);
            // Proceed to Auth.confirmSignIn
            break;
          case 'SELECT_MFA_TYPE':
          const mfaType = 'SMS_MFA' // or 'SOFTWARE_TOKEN_MFA'
          // user returned from signIn
          user.sendMFASelectionAnswer(mfaType, {
            onFailure: (err) => {
              console.log(err);
            },
            mfaRequired: (challengeName, parameters)=>{
              // call confirmSignIn with OTP code sent to your cellphone
            },
            totpRequired: (challengeName, parameters)=>{
              // call confirmSignIn with OTP code retrieved from your authenticator App
            }
          });
            break;
          case 'NEW_PASSWORD_REQUIRED':
            const {
              userAttributes,
              requiredAttributes
            } = user.challengeParams;
            const attributes = { ... };

            const confirmedUser = await Auth.completeNewPassword(
              user,
              'newPassword',
              attributes
            );
            break;
        }
      }
    }
    ```

  </div>
  <div>
    **V6**
    
    ```
    import {
      confirmSignIn,
      signIn
    } from 'aws-amplify/auth';

    const handleSignIn = async ({
      username,
      password
    }) => {
      const {
        isSignIn,
        nextStep
      } = await signIn({ username, password });

      switch (nextStep.signInStep) {
        case 'CONFIRM_SIGN_IN_WITH_TOTP_CODE':
        case 'CONFIRM_SIGN_IN_WITH_SMS_CODE':
          // nextStep will contain codeDeliveryDetails when step is CONFIRM_SIGN_IN_WITH_SMS_CODE
          const {
            isSignedIn,
            nextStep
          } = await confirmSignIn({ challengeResponse: 'code' });
          break;
        case 'CONFIRM_SIGN_IN_WITH_CUSTOM_CHALLENGE':
          const { additionalInfo } = nextStep;
          const {
            isSignedIn,
            nextStep
          } = await confirmSignIn({ challengeResponse: 'answer' });
          break;
        case 'CONTINUE_SIGN_IN_WITH_TOTP_SETUP':
          // Note that calling setupTOTP is unnecessary in this scenario
          // totpSetupDetails are already returned with nextStep
          const { totpSetupDetails } = nextStep;
          const appName = 'my_app_name';
          const setupUri = totpSetupDetails.getSetupUri(appName);
          // Open setupUri with an authenticator APP to retrieve an OTP code
          // Retrieve code from authenticator App
          const {
            isSignedIn,
            nextStep
          } = await confirmSignIn({ challengeResponse: 'code' });
          break;
        case 'CONTINUE_SIGN_IN_WITH_MFA_SELECTION':

        const mfaType = 'SMS' // or TOTP
        const {
            isSignedIn,
            nextStep
          } = await confirmSignIn({ challengeResponse: mfaType});

          // if confirmSignIn was called with 'SMS', then the next
          // step will be 'CONFIRM_SIGN_IN_WITH_SMS_CODE'.
          // However if 'TOTP' was used as input then 'CONFIRM_SIGN_IN_WITH_TOTP_CODE'
          // will be returned.

          const otpCode = '123456' // code retrieved from authenticator App or cellphone
          const {
            isSignedIn,
            nextStep
          } = await confirmSignIn({ challengeResponse: otpCode});
          break;
        case 'CONFIRM_SIGN_IN_WITH_NEW_PASSWORD_REQUIRED':
          const { missingAttributes } = nextStep;
          const userAttributes = { ... };

          const {
            isSignedIn,
            nextStep
          } = await confirmSignIn({
            challengeResponse: 'newPassword',
            options: {
              userAttributes
            }
          });
          break;
        case 'DONE':
          break;
      }
    }
    ```

  </div>
</Columns>

### Example 3 (Legacy)

<Columns columns={2}>
  <div>
    **V5**
    
    ```
    import { Auth } from 'aws-amplify';

    const handleSignIn = async ({
      username,
      password
    }) => {
      const user = await Auth.resendSignUp(
        username,
        password
      );
    }
    ```

  </div>
  <div>
    **V6**
    
    ```
    import { signIn } from 'aws-amplify/auth';

    const username = 'username';
    const password = 'password';

    const handleSignIn = async ({
      username,
      password
    }) => {
      const {
        isSignIn,
        nextStep
      } = await signIn({ username, password });
    }
    ```

  </div>
</Columns>

## Auth.federatedSignIn

**NOTE:** The usage of `federatedSignIn` with Identity Pools is deprecated. If you are using an Identity Pool for authentication, please follow [this guide](/[platform]/build-a-backend/auth/advanced-workflows/#identity-pool-federation).

```diff
-  import { Auth } from 'aws-amplify';
+  import { signInWithRedirect } from 'aws-amplify/auth';

-  Auth.federatedSignIn: (providerOrOptions: LegacyProvider | FederatedSignInOptions | FederatedSignInOptionsCustom, response?: FederatedResponse, user?: FederatedUser) => Promise<ICredentials>;
+  signInWithRedirect: (input?: SignInWithRedirectInput) => Promise<void>;
```

<Accordion title='Input' headingLevel='3'>
  <Columns columns={2}>
    <div>
      **V5**
      
      ```
      // Standard
      options?: FederatedSignInOptions {
        provider: { // enum
          Cognito = 'COGNITO',
          Google = 'Google',
          Facebook = 'Facebook',
          Amazon = 'LoginWithAmazon',
          Apple = 'SignInWithApple',
        };
        customState?: string;
      }

      // Custom Provider
      options?: FederatedSignInOptionsCustom {
        customProvider: string;
        customState?: string;
      }

      // Legacy
      provider:
        | 'google'
        | 'facebook'
        | 'amazon'
        | 'developer'
        | string
      response: FederatedResponse {
        token: string;
        identity_id?: string;
        expires_at: number;
      }
      user: FederatedUser {
        name: string;
        email?: string;
        picture?: string;
      }
      ```

    </div>
    <div>
      **V6**
      
      ```
      input?: SignInWithRedirectInput {
        provider?:
          | 'Amazon'
          | 'Apple'
          | 'Facebook'
          | 'Google'
          | { custom: string; };
        customState?: string;
        options?: {
          preferPrivateSession?: boolean;
        };
      }
      ```
    
    </div>
  </Columns>
</Accordion>

<Accordion title='Output' headingLevel='3'>
  <Columns columns={2}>
    <div>
      **V5**
      
      ```
      ICredentials {
        accessKeyId: string;
        sessionToken: string;
        secretAccessKey: string;
        identityId: string;
        authenticated: boolean;
        expiration?: Date;
      }
      ```
    
    </div>
    <div>
      **V6**

      No output in v6

    </div>
  </Columns>
</Accordion>

### Example 1 (Standard)

<Columns columns={2}>
  <div>
    **V5**
    
    ```
    import { Auth } from 'aws-amplify';

    const handleSocialSignIn = async () => {
      const credentials = await Auth.federatedSignIn({
        provider: CognitoHostedUIIdentityProvider.Google
      });
    }
    ```

  </div>
  <div>
    **V6**
    
    ```
    import {
      fetchAuthSession,
      signInWithRedirect
    } from 'aws-amplify/auth';

    const handleSocialSignIn = async () => {
      await signInWithRedirect({
        provider: 'Google'
      });
    }
    ```

  </div>
</Columns>

### Example 2 (Custom Provider)

<Columns columns={2}>
  <div>
    **V5**
    
    ```
    import { Auth } from 'aws-amplify';

    const handleSocialSignIn = () => {
      Auth.federatedSignIn({
        customProvider: 'SocialProvider'
      });
    }
    ```

  </div>
  <div>
    **V6**
    
    ```
    import { signInWithRedirect } from 'aws-amplify/auth';

    const handleSocialSignIn = () => {
      signInWithRedirect({
        provider: {
          custom: 'SocialProvider'
        }
      });
    }
    ```

  </div>
</Columns>

### Example 3 (Defaults)

<Columns columns={2}>
  <div>
    **V5**
    
    ```
    import { Auth } from 'aws-amplify';

    const handleSocialSignIn = () => {
      Auth.federatedSignIn();
    }
    ```

  </div>
  <div>
    **V6**
    
    ```
    import { signInWithRedirect } from 'aws-amplify/auth';

    const handleSocialSignIn = () => {
      signInWithRedirect();
    }
    ```

  </div>
</Columns>

### Example 4 (Legacy - DEPRECATED)

<Columns columns={2}>
  <div>
    **V5**
    
    ```
    import { Auth } from 'aws-amplify';

    const handleSocialSignIn = async ({
      token,
      identityId?,
      expires_at,
      name,
      email?,
      picture?
    }) => {
      const credentials = await Auth.federatedSignIn(
        'google',
        {
          token,
          identity_id?,
          expires_at
        },
        {
          name,
          email?,
          picture?
        }
      );
    }
    ```

  </div>
  <div>
    **V6**
    
    `signInWithRedirect` does not allow you to pass a pre-authorized user and tokens for Amplify to consume. Follow [this guide](http://localhost:3000/react/build-a-backend/auth/advanced-workflows/#identity-pool-federation) as an example of how to accomplish this in v6.

  </div>
</Columns>

## Auth.confirmSignIn

**NOTE:** For more details on possible `output.nextStep` details compared with v5's `user.challengeName` and `user.challengeParams`, see [Auth.signIn Example 2](/[platform]/build-a-backend/auth/auth-migration-guide/#example-2-confirmation-required)

```diff
-  import { Auth } from 'aws-amplify';
+  import { confirmSignIn } from 'aws-amplify/auth';

-  Auth.confirmSignIn: (user: CognitoUser | any, code: string, mfaType?: 'SMS_MFA' | 'SOFTWARE_TOKEN_MFA' | null, clientMetadata?: ClientMetaData) => Promise<CognitoUser | any>;
+  confirmSignIn: (input: ConfirmSignInInput) => Promise<ConfirmSignInOutput>;
```

<Accordion title='Input' headingLevel='3'>
  <Columns columns={2}>
    <div>
      **V5**
      
      ```
      user: CognitoUser
      code: string
      mfaType?: 'SMS_MFA' | 'SOFTWARE_TOKEN_MFA' | null
      clientMetadata?: ClientMetaData {
        [key: string]: string;
      }
      ```

    </div>
    <div>
      **V6**
      
      ```
      input: ConfirmSignInInput {
        challengeResponse: string;
        options?: {
          userAttributes?: AuthUserAttributes;
          clientMetadata?: ClientMetaData {
            [key: string]: string;
          }
          friendlyDeviceName?: string;
        };
      }
      ```
    </div>
  </Columns>
</Accordion>

<Accordion title='Output' headingLevel='3'>
  <Columns columns={2}>
    <div>
      **V5**
      
      ```
      CognitoUser {
        challengeName?: string;
        challengeParam?: string;
        username: string;
        signInUserSession: {
          idToken: string;
          refreshToken: string;
          accessToken: string;
          clockDrift: number;
        } | null;
        authenticationFlowType: string;
      }
      ```

    </div>
    <div>
      **V6**
      
      ```
      ConfirmSignInOutput {
        isSignedIn: boolean;
        nextStep:
          | ContinueSignInWithMFASelection
          | ContinueSignInWithTOTPSetup
          | ConfirmSignInWithSMSCode
          | ConfirmSignInWithTOTPCode
          | ConfirmSignInWithCustomChallenge
          | ConfirmSignInWithNewPasswordRequired<UserAttributeKey>
          | ConfirmSignUpStep
          | ResetPasswordStep
          | DoneSignInStep;
      }
      ```
    </div>
  </Columns>
</Accordion>

### Example

<Columns columns={2}>
  <div>
    **V5**
    
    ```
    import { Auth } from 'aws-amplify';

    const handleConfirmSignIn = async ({
      user,
      code,
      mfaType
    }) => {
      const user = await Auth.confirmSignIn(
        user,
        code,
        mfaType
      );
    }

    ```

  </div>
  <div>
    **V6**
    
    ```
    import { confirmSignIn } from 'aws-amplify/auth';

    const handleConfirmSignIn = async ({ challengeResponse }) => {
      const {
        isSignedIn,
        nextStep
      } = await confirmSignIn({ challengeResponse });
    }
    ```

  </div>
</Columns>

## Auth.setupTOTP

```diff
-  import { Auth } from 'aws-amplify';
+  import { setUpTOTP } from 'aws-amplify/auth';

-  Auth.setupTOTP: (user: CognitoUser | any) => Promise<string>;
+  setUpTOTP: () => Promise<SetUpTOTPOutput>;
```

<Accordion title='Input' headingLevel='3'>
  <Columns columns={2}>
    <div>
      **V5**

      ```
      user: CognitoUser
      ```

    </div>
    <div>
      **V6**

      No input in v6

    </div>
  </Columns>
</Accordion>

<Accordion title='Output' headingLevel='3'>
  <Columns columns={2}>
    <div>
      **V5**
      
      ```
      string // secretCode
      ```

    </div>
    <div>
      **V6**

      ```
      SetUpTOTPOutput {
        sharedSecret: string;
        getSetupUri: (appName: string, accountName?: string | undefined) => URL;
      }
      ```

    </div>
  </Columns>
</Accordion>

### Example

<Columns columns={2}>
  <div>
    **V5**
    
    ```
    import { Auth } from 'aws-amplify';

    const handleSetupTOTP = async ({ user }) => {
      const secretCode = await Auth.setupTOTP(user);
      const setupUri = `otpauth://totp/AWSCognito:${user}?secret=${secretCode}&issuer=sample-app`;
    }
    ```

  </div>
  <div>
    **V6**
    
    ```
    import { setUpTOTP } from 'aws-amplify/auth';

    const handleSetupTOTP = async () => {
      const output = await setUpTOTP();
      const secretCode = output.sharedSecret;
      const setupUri = output.getSetupUri('sample-app');
    }
    ```

  </div>
</Columns>

## Auth.verifyTotpToken

```diff
-  import { Auth } from 'aws-amplify';
+  import { verifyTOTPSetup } from 'aws-amplify/auth';

-  Auth.verifyTotpToken(user: CognitoUser | any, challengeAnswer: string) => Promise<CognitoUserSession>;
+  verifyTOTPSetup: (input: VerifyTOTPSetupInput) => Promise<void>;
```

<Accordion title='Input' headingLevel='3'>
  <Columns columns={2}>
    <div>
      **V5**
      
      ```
      user: CognitoUser
      challengeAnswer: string
      ```

    </div>
    <div>
      **V6**
      
      ```
      input: VerifyTOTPSetupInput {
        code: string;
        options?: {
          friendlyDeviceName?: string;
        }
      }
      ```

    </div>
  </Columns>
</Accordion>

<Accordion title='Output' headingLevel='3'>
  <Columns columns={2}>
    <div>
      **V5**
      
      ```
      CognitoUserSession {
        idToken: string;
        refreshToken: string;
        accessToken: string;
        clockDrift: number;
      }
      ```

    </div>
    <div>
      **V6**

      No output in v6

    </div>
  </Columns>
</Accordion>

### Example

<Columns columns={2}>
  <div>
    **V5**
    
    ```
    import { Auth } from 'aws-amplify';

    const handleVerifyTOTP = async ({ user, code }) => {
      const userSession = await Auth.verifyTotpToken(user, code);
    }

    ```

  </div>
  <div>
    **V6**
    
    ```
    import { verifyTOTPSetup } from 'aws-amplify/auth';

    const handleVerifyTOTP = async ({ code }) => {
      await verifyTOTPSetup({ code , options });
    }
    ```

  </div>
</Columns>

## Auth.completeNewPassword (DEPRECATED)

This API has been deprecated: existing use cases can be migrated to the `confirmSignIn` API

```diff
-  import { Auth } from 'aws-amplify';
+  import { confirmSignIn } from 'aws-amplify/auth';

-  Auth.completeNewPassword: (user: CognitoUser | any, password: string, requiredAttributes: any = {}, clientMetadata?: ClientMetaData) => Promise<CognitoUser | any>;
+  confirmSignIn: (input: ConfirmSignInInput) => Promise<ConfirmSignInOutput>;
```

<Accordion title='Input' headingLevel='3'>
  <Columns columns={2}>
    <div>
      **V5**
      
      ```
      user: CognitoUser
      password: string
      requiredAttributes?: any
      clientMetadata?: ClientMetaData {
        [key: string]: string;
      }
      ```

    </div>
    <div>
      **V6**
      
      ```
      input: ConfirmSignInInput {
        challengeResponse: string;
        options?: {
          userAttributes?: AuthUserAttributes;
          clientMetadata?: ClientMetaData {
            [key: string]: string;
          }
          friendlyDeviceName?: string;
        };
      }
      ```
    
    </div>
  </Columns>
</Accordion>

<Accordion title='Output' headingLevel='3'>
  <Columns columns={2}>
    <div>
      **V5**
      
      ```
      CognitoUser {
        challengeName?: string;
        challengeParam?: string;
        username: string;
        signInUserSession: {
          idToken: string;
          refreshToken: string;
          accessToken: string;
          clockDrift: number;
        } | null;
        authenticationFlowType: string;
      }
      ```

    </div>
    <div>
      **V6**
      
      ```
      ConfirmSignInOutput {
        isSignedIn: boolean;
        nextStep: // See Auth.signIn Example 2 for more details on nextStep types
          | ContinueSignInWithMFASelection
          | ContinueSignInWithTOTPSetup
          | ConfirmSignInWithSMSCode
          | ConfirmSignInWithTOTPCode
          | ConfirmSignInWithCustomChallenge
          | ConfirmSignInWithNewPasswordRequired<UserAttributeKey>
          | ConfirmSignUpStep
          | ResetPasswordStep
          | DoneSignInStep;
      }
      ```
    
    </div>
  </Columns>
</Accordion>

### Example

<Columns columns={2}>
  <div>
    **V5**
    
    ```
    import { Auth } from 'aws-amplify';

    const handleUpdatePassword = async ({
      user,
      newPassword,
      attributes
    }) => {
      const user = await Auth.completeNewPassword(
        user,
        newPassword,
        attributes
      );
    }
    ```

  </div>
  <div>
    **V6**
    
    ```
    import { confirmSignIn } from 'aws-amplify/auth';

    const handleUpdatePassword = async ({ newPassword }) => {
      const {
        isSignedIn,
        nextStep
      } = await confirmSignIn({ challengeResponse: newPassword });
    }
    ```

  </div>
</Columns>

## Auth.sendCustomChallengeAnswer (DEPRECATED)

This API has been deprecated: existing use cases can be migrated to the `confirmSignIn` API

```diff
-  import { Auth } from 'aws-amplify';
+  import { confirmSignIn } from 'aws-amplify/auth';

-  Auth.sendCustomChallengeAnswer: (user: CognitoUser | any, challengeResponses: string, clientMetadata?: ClientMetaData) => Promise<CognitoUser | any>;
+  confirmSignIn: (input: ConfirmSignInInput) => Promise<ConfirmSignInOutput>;
```

<Accordion title='Input' headingLevel='3'>
  <Columns columns={2}>
    <div>
      **V5**
      
      ```
      user: CognitoUser
      challengeResponses: string
      clientMetadata?: ClientMetaData {
        [key: string]: string;
      }
      ```

    </div>
    <div>
      **V6**
      
      ```
      input: ConfirmSignInInput {
        challengeResponse: string;
        options?: {
          userAttributes?: AuthUserAttributes;
          clientMetadata?: ClientMetaData {
            [key: string]: string;
          }
          friendlyDeviceName?: string;
        };
      }
      ```

    </div>
  </Columns>
</Accordion>

<Accordion title='Output' headingLevel='3'>
  <Columns columns={2}>
    <div>
      **V5**
      
      ```
      CognitoUser {
        challengeName?: string;
        challengeParam?: string;
        username: string;
        signInUserSession: {
          idToken: string;
          refreshToken: string;
          accessToken: string;
          clockDrift: number;
        } | null;
        authenticationFlowType: string;
      }
      ```

    </div>
    <div>
      **V6**
      
      ```
      ConfirmSignInOutput {
        isSignedIn: boolean;
        nextStep: // See Auth.signIn Example 2 for more details on nextStep types
          | ContinueSignInWithMFASelection
          | ContinueSignInWithTOTPSetup
          | ConfirmSignInWithSMSCode
          | ConfirmSignInWithTOTPCode
          | ConfirmSignInWithCustomChallenge
          | ConfirmSignInWithNewPasswordRequired<UserAttributeKey>
          | ConfirmSignUpStep
          | ResetPasswordStep
          | DoneSignInStep;
      }
      ```

    </div>
  </Columns>
</Accordion>

### Example

<Columns columns={2}>
  <div>
    **V5**
    
    ```
    import { Auth } from 'aws-amplify';

    const handleConfirmSignIn = async ({
      user,
      code
    }) => {
      const user = await Auth.confirmSignIn(
        user,
        code
      );
    }
    ```

  </div>
  <div>
    **V6**
    
    ```
    import { confirmSignIn } from 'aws-amplify/auth';

    const handleConfirmSignIn = async ({ challengeResponse }) => {
      const {
        isSignedIn,
        nextStep
      } = await confirmSignIn({ challengeResponse });
    }
    ```

  </div>
</Columns>

## Auth.getPreferredMFA

```diff
-  import { Auth } from 'aws-amplify';
+  import { fetchMFAPreference } from 'aws-amplify/auth';

-  Auth.getPreferredMFA: (user: CognitoUser | any, params?: GetPreferredMFAOpts) => Promise<string>;
+  fetchMFAPreference: () => Promise<FetchMFAPreferenceOutput>;
```

<Accordion title='Input' headingLevel='3'>
  <Columns columns={2}>
    <div>
      **V5**
      
      ```
      user: CognitoUser
      params?: GetPreferredMFAOpts {
        bypassCache: boolean;
      }
      ```
    </div>
    <div>
      **V6**

      No input in v6

    </div>
  </Columns>
</Accordion>

<Accordion title='Output' headingLevel='3'>
  <Columns columns={2}>
    <div>
      **V5**
      
      ```
      'SMS' | 'TOTP'
      ```

    </div>
    <div>
      **V6**
      
      ```
      FetchMFAPreferenceOutput: {
        enabled?: ('SMS' | 'TOTP')[];
        preferred?: 'SMS' | 'TOTP';
      }
      ```

    </div>
  </Columns>
</Accordion>

### Example

<Columns columns={2}>
  <div>
    **V5**
    
    ```
    import { Auth } from 'aws-amplify';

    const getPreferredMFA = async ({ user }) => {
      const preferredMFA = await Auth.getPreferredMFA(user);
      return preferredMFA;
    }
    ```

  </div>
  <div>
    **V6**
    
    ```
    import { fetchMFAPreference } from 'aws-amplify/auth';

    const getPreferredMFA = async () => {
      const { preferred } = await fetchMFAPreference();
      return preferred;
    }
    ```

  </div>
</Columns>

## Auth.setPreferredMFA

```diff
-  import { Auth } from 'aws-amplify';
+  import { updateMFAPreference } from 'aws-amplify/auth';

-  Auth.setPreferredMFA: (user: CognitoUser | any, mfaMethod: 'TOTP' | 'SMS' | 'NOMFA' | 'SMS_MFA' | 'SOFTWARE_TOKEN_MFA') => Promise<string>;
+  updateMFAPreference: (input: UpdateMFAPreferenceInput) => Promise<void>;
```

<Accordion title='Input' headingLevel='3'>
  <Columns columns={2}>
    <div>
      **V5**
      
      ```
      user: CognitoUser
      mfaMethod: 
        | 'TOTP'
        | 'SMS'
        | 'NOMFA'
        | 'SMS_MFA'
        | 'SOFTWARE_TOKEN_MFA'
      ```

    </div>
    <div>
      **V6**
      
      ```
      input: UpdateMFAPreferenceInput {
        sms?:
          | 'ENABLED'
          | 'DISABLED'
          | 'PREFERRED'
          | 'NOT_PREFERRED'
        mfa?:
          | 'ENABLED'
          | 'DISABLED'
          | 'PREFERRED'
          | 'NOT_PREFERRED'
      }
      ```
    </div>
  </Columns>
</Accordion>

<Accordion title='Output' headingLevel='3'>
  <Columns columns={2}>
    <div>
      **V5**

      ```
      'No change for mfa type' | 'SUCCESS'
      ```

    </div>
    <div>
      **V6**

      No output in v6

    </div>
  </Columns>
</Accordion>

### Example

<Columns columns={2}>
  <div>
    **V5**
    
    ```
    import { Auth } from 'aws-amplify';

    const handleSetPreferredMFA = async ({ user }) => {
      await Auth.setPreferredMFA(user, 'TOTP');
    }
    ```

  </div>
  <div>
    **V6**
    
    ```
    import { updateMFAPreference } from 'aws-amplify/auth';

    const handleSetPreferredMFA = async ({ user }) => {
      await updateMFAPreference({ mfa: 'PREFERRED' });
    }
    ```

  </div>
</Columns>

## Auth.getMFAOptions (DEPRECATED)

This API has been deprecated and results apply only to SMS MFA configurations: existing use cases can be migrated to `fetchMFAPreference`, which will apply to both SMS and TOTP configurations

```diff
-  import { Auth } from 'aws-amplify';
+  import { fetchMFAPreference } from 'aws-amplify/auth';

-  Auth.getMFAOptions: (user: CognitoUser | any) => Promise<MFAOption[]>;
+  fetchMFAPreference: () => Promise<FetchMFAPreferenceOutput>
```

<Accordion title='Input' headingLevel='3'>
  <Columns columns={2}>
    <div>
      **V5**
      
      ```
      user: CognitoUser
      ```

    </div>
    <div>
      **V6**

      No input in v6

    </div>
  </Columns>
</Accordion>

<Accordion title='Output' headingLevel='3'>
  <Columns columns={2}>
    <div>
      **V5**
      
      ```
      MFAOption[]: {
        DeliveryMedium: 'SMS' | ~~'EMAIL'~~;
        AttributeName: string;
      }[]
      ```

    </div>
    <div>
      **V6**
      
      ```
      FetchMFAPreferenceOutput: {
        enabled?: ('SMS' | 'TOTP')[];
        preferred?: 'SMS' | 'TOTP';
      }
      ```

    </div>
  </Columns>
</Accordion>

### Example

<Columns columns={2}>
  <div>
    **V5**
    
    ```
    import { Auth } from 'aws-amplify';

    const getEnabledMFAOptions = async ({ user }) => {
      const mfaOptions = await Auth.getMFAOptions(user);
      const enabled: string[] = [];
      for(let option of mfaOptions) {
        enabled.push(option.DeliverMedium);
      }
      return enabled;
    }
    ```

  </div>
  <div>
    **V6**
    
    ```
    import { fetchMFAPreference } from 'aws-amplify/auth';

    const getEnabledMFAOptions = async () => {
      const { enabled } = await fetchMFAPreference();
      return enabled;
    }
    ```

  </div>
</Columns>

## Auth.signOut

```diff
-  import { Auth } from 'aws-amplify';
+  import { signOut } from 'aws-amplify/auth';

-  Auth.signOut: (opts?: SignOutOpts) => Promise<any>; // Does not return
+  signOut: (input?: SignOutInput) => Promise<void>;
```

<Accordion title='Input' headingLevel='3'>
  <Columns columns={2}>
    <div>
      **V5**
      
      ```
      opts?: SignOutOpts {
        global?: boolean;
      }
      ```

    </div>
    <div>
      **V6**
      
      ```
      input?: SignOutInput {
        global: boolean;
      }
      ```
    
    </div>
  </Columns>
</Accordion>

### Example

<Columns columns={2}>
  <div>
    **V5**
    
    ```
    import { Auth } from 'aws-amplify';

    const handleSignOut = async () => {
      await Auth.signOut();
    }
    ```

  </div>
  <div>
    **V6**
    
    ```
    import { signOut } from 'aws-amplify/auth';

    const handleSignOut = async () => {
      await signOut();
    }
    ```

  </div>
</Columns>

## Auth.changePassword

```diff
-  import { Auth } from 'aws-amplify';
+  import { updatePassword } from 'aws-amplify/auth';

-  Auth.changePassword: (user: CognitoUser | any, oldPassword: string, newPassword: string, clientMetadata?: ClientMetaData) => Promise<'SUCCESS'>;
+  updatePassword: (input: UpdatePasswordInput) => Promise<void>;
```

<Accordion title='Input' headingLevel='3'>
  <Columns columns={2}>
    <div>
      **V5**
      
      ```
      user: CognitoUser
      oldPassword: string
      newPassword: string
      clientMetadata?: ClientMetaData {
        [key: string]: string
      }
      ```

    </div>
    <div>
      **V6**
      
      ```
      input: UpdatePasswordInput {
        oldPassword: string;
        newPassword: string;
      }
      ```
    </div>
  </Columns>
</Accordion>

<Accordion title='Output' headingLevel='3'>
  <Columns columns={2}>
    <div>
      **V5**
      
      ```
      'SUCCESS'
      ```
      
    </div>
    <div>
      **V6**

      No output in v6

    </div>
  </Columns>
</Accordion>

### Example

<Columns columns={2}>
  <div>
    **V5**
    
    ```
    import { Auth } from 'aws-amplify';

    const handleChangePassword = async ({
      user,
      oldPassword,
      newPassword
    }) => {
      await Auth.changePassword(
        user,
        oldPassword,
        newPassword
      );
    }
    ```

  </div>
  <div>
    **V6**
    
    ```
    import { updatePassword } from 'aws-amplify/auth';

    const handleChangePassword = async ({
      oldPassword,
      newPassword
    }) => {
      await updatePassword({
        oldPassword,
        newPassword
      });
    }
    ```

  </div>
</Columns>

## Auth.forgotPassword

```diff
-  import { Auth } from 'aws-amplify';
+  import { resetPassword } from 'aws-amplify/auth';

-  Auth.forgotPassword: (username: string, clientMetadata?: ClientMetaData) => Promise<any>;
+  resetPassword: (input: ResetPasswordInput) => Promise<ResetPasswordOutput>;
```

<Accordion title='Input' headingLevel='3'>
  <Columns columns={2}>
    <div>
      **V5**
      
      ```
      username: string
      clientMetadata?: ClientMetaData {
        [key: string]: string;
      }
      ```

    </div>
    <div>
      **V6**
      
      ```
      input: ResetPasswordInput {
        username: string;
        options?: {
          clientMetadata?: {
            [key: string]: string;
          };
        };
      }
      ```

    </div>
  </Columns>
</Accordion>

<Accordion title='Output' headingLevel='3'>
  <Columns columns={2}>
    <div>
      **V5**
      
      ```
      {
        CodeDeliveryDetails: {
          AttributeName: string;
          DeliveryMedium: string;
          Destination: string;
        }
      }
      ```

    </div>
    <div>
      **V6**
      
      ```
      ResetPasswordOutput {
        isPasswordReset: boolean;
        nextStep: {
          resetPasswordStep: 
            | 'CONFIRM_RESET_PASSWORD_WITH_CODE'
            | 'DONE';
          additionalInfo?: { 
            [key: string]: string;
          };
          codeDeliveryDetails: {
            destination?: string;
            deliveryMedium?: 
              | 'EMAIL'
              | 'SMS'
              | 'PHONE'
              | 'UNKNOWN';
            attributeName?: 'email' | 'phone_number';
          };
        };
      }
      ```
    
    </div>
  </Columns>
</Accordion>

### Example

<Columns columns="2">
  <div>
    **V5**
    
    ```
    import { Auth } from 'aws-amplify';

    const handleResetPassword = async ({
      username,
      clientMetadata
    }) => {
      const result = await Auth.forgotPassword(
        username,
        clientMetadata
      );

      const {
        AttributeName,
        DeliveryMedium,
        Destination
      } = result.CodeDeliveryDetails;
    }
    ```

  </div>
  <div>
    **V6**
    
    ```
    import { resetPassword } from 'aws-amplify/auth';

    const handleResetPassword = async ({
      username,
      clientMetadata
    }) => {
      const result = await resetPassword({
        username,
        options: {
          clientMetadata
        }
      });
      const {
        attributeName,
        deliveryMedium,
        destination
      } = result.nextStep.codeDeliveryDetails;
    }
    ```

  </div>
</Columns>

## Auth.forgotPasswordSubmit

```diff
-  import { Auth } from 'aws-amplify';
+  import { confirmResetPassword } from 'aws-amplify/auth';

-  Auth.forgotPasswordSubmit: (username: string, code: string, password: string, clientMetadata?: ClientMetaData) => Promise<string>;
+  confirmResetPassword: (input: ConfirmResetPasswordInput) => Promise<void>;
```

<Accordion title='Input' headingLevel='3'>
  <Columns columns="2">
    <div>
      **V5**
      
      ```
      username: string
      code: string
      password: string
      clientMetadata?: ClientMetaData {
        [key: string]: string;
      };
      ```
    
    </div>
    <div>
      **V6**
      
      ```
      input: ConfirmResetPasswordInput {
        username: string;
        newPassword: string;
        confirmationCode: string;
        options?: {
          clientMetadata?: {
            [key: string]: string;
          };
        };
      }
      ```

    </div>
  </Columns>
</Accordion>

<Accordion title='Output' headingLevel='3'>
  <Columns columns="2">
    <div>
      **V5**
      ```
      'SUCCESS'
      ```
      
    </div>
    <div>
      **V6**

      No output in v6

    </div>
  </Columns>
</Accordion>

### Example

<Columns columns="2">
  <div>
    **V5**
    
    ```
    import { Auth } from 'aws-amplify';

    const handleConfirmResetPassword = async ({
      username,
      newPassword,
      confirmationCode,
      clientMetadata
    }) => {
      await Auth.forgotPasswordSubmit(
        username,
        confirmationCode,
        newPassword,
        clientMetadata
      );
    }
    ```

  </div>
  <div>
    **V6**
    
    ```
    import { confirmResetPassword } from 'aws-amplify/auth';

    const handleConfirmResetPassword = async ({
      username,
      newPassword,
      confirmationCode,
      clientMetadata
    }) => {
      await confirmResetPassword: ({
        username,
        newPassword,
        confirmationCode,
        options: {
          clientMetadata
        }
      });
    }
    ```

  </div>
</Columns>

## Auth.deleteUser

```diff
-  import { Auth } from 'aws-amplify';
+  import { deleteUser } from 'aws-amplify/auth';

-  Auth.deleteUser: () => Promise<string | void>;
+  deleteUser: () => Promise<void>;
```

### Example

<Columns columns={2}>
  <div>
    **V5**
    
    ```
    import { Auth } from 'aws-amplify';

    const handleDeleteUser = async () => {
      await Auth.deleteUser();
    }
    ```

  </div>
  <div>
    **V6**
    
    ```
    import { deleteUser } from 'aws-amplify/auth';

    const handleDeleteAttributes = async ({ attributes }) => {
      await deleteUser();
    }
    ```

  </div>
</Columns>

## Auth.currentAuthenticatedUser (DEPRECATED)

This API has been deprecated: existing use cases can be migrated to a combination of the `getCurrentUser` and `fetchAuthSession` API's.

**Note:** we no longer return `refreshToken` or `clockDrift` with the `AuthSession`. These values are used under the hood to refresh/validate the user session

```diff
-  import { Auth } from 'aws-amplify';
+  import { fetchAuthSession, getCurrentUser } from 'aws-amplify/auth';

-  Auth.currentAuthenticatedUser: (params?: CurrentUserOpts) => Promise<CognitoUser | any>;
+  getCurrentUser: () => Promise<GetCurrentUserOutput>;
+  fetchAuthSession: (options?: FetchAuthSessionOptions) => Promise<AuthSession>;
```

<Accordion title='Input' headingLevel='3'>
  <Columns columns={2}>
    <div>
      **V5**
      
      ```
      params?: CurrentUserOpts {
        bypassCache: boolean;
      }
      ```

    </div>
    <div>
      **V6**
      
      ```
      // fetchAuthSession
      options?: FetchAuthSessionOptions {
        forceRefresh?: boolean;
      }
      ```

    </div>
  </Columns>
</Accordion>

<Accordion title='Output' headingLevel='3'>
  <Columns columns={2}>
    <div>
      **V5**
      
      ```
      CognitoUser {
        username: string;
        signInUserSession: {
          idToken: string;
          refreshToken: string;
          accessToken: string;
          clockDrift: number;
        } | null;
        authenticationFlowType: string;
      }
      ```

    </div>
    <div>
      **V6**
      
      ```
      // getCurrentUser
      GetCurrentUserOutput: {
        username: string;
        userId: string;
        signInDetails?: {
          loginId?: string;
          authFlowType?: 
            | 'USER_SRP_AUTH'
            | 'CUSTOM_WITH_SRP'
            | 'CUSTOM_WITHOUT_SRP'
            | 'USER_PASSWORD_AUTH';;
        };
      }

      // fetchAuthSession
      AuthSession {
        tokens?: {
          idToken?: JWT;
          accessToken: JWT;
        };
        credentials?: {
          accessKeyId: string;
          secretAccessKey: string;
          sessionToken?: string;
          expiration?: Date;
        };
        identityId?: string;
        userSub?: string;
      }
      ```

    </div>
  </Columns>
</Accordion>

### Example

<Columns columns={2}>
  <div>
    **V5**
    
    ```
    import { Auth } from 'aws-amplify';

    const getAuthenticatedUser = async () => {
      const {
        username,
        signInUserSession: session,
        authenticationFlowType
      } = await Auth.currentAuthenticatedUser();

      return {
        username,
        session,
        authenticationFlowType
      };
    }
    ```

  </div>
  <div>
    **V6**
    
    ```
    import {
      fetchAuthSession,
      getCurrentUser
    } from 'aws-amplify/auth';

    const getAuthenticatedUser = async () => {
      const {
        username,
        authFlowType: authenticationFlowType
      } = await getCurrentUser();

      const {
        tokens: session
      } = await fetchAuthSession();

      // Note that session will no longer contain refreshToken and clockDrift
      return {
        username,
        session,
        authenticationFlowType
      };
    }
    ```

  </div>
</Columns>

## Auth.currentUserPoolUser (DEPRECATED)

This API has been deprecated: existing use cases can be migrated to a combination of the `getCurrentUser` and `fetchAuthSession` API's.

```diff
-  import { Auth } from 'aws-amplify';
+  import { getCurrentUser } from 'aws-amplify/auth';

-  Auth.currentUserPoolUser: (params?: CurrentUserOpts) => Promise<CognitoUser | any>;
+  getCurrentUser: () => Promise<GetCurrentUserOutput>;
+  fetchAuthSession: (options?: FetchAuthSessionOptions) => Promise<AuthSession>;
```

<Accordion title='Input' headingLevel='3'>
  <Columns columns={2}>
    <div>
      **V5**
      
      ```
      params?: CurrentUserOpts {
        bypassCache: boolean;
      }
      ```

    </div>
    <div>
      **V6**
      
      ```
      // fetchAuthSession
      options?: FetchAuthSessionOptions {
        forceRefresh?: boolean;
      }
      ```

    </div>
  </Columns>
</Accordion>

<Accordion title='Output' headingLevel='3'>
  <Columns columns={2}>
    <div>
      **V5**
      
      ```
      CognitoUser {
        username: string;
        signInUserSession: {
          idToken: string;
          refreshToken: string;
          accessToken: string;
          clockDrift: number;
        } | null;
        authenticationFlowType: string;
      }
      ```

    </div>
    <div>
      **V6**
      
      ```
      // getCurrentUser
      GetCurrentUserOutput: {
        username: string;
        userId: string;
        signInDetails?: {
          loginId?: string;
          authFlowType?: 
            | 'USER_SRP_AUTH'
            | 'CUSTOM_WITH_SRP'
            | 'CUSTOM_WITHOUT_SRP'
            | 'USER_PASSWORD_AUTH';;
        };
      }

      // fetchAuthSession
      AuthSession {
        tokens?: {
          idToken?: JWT;
          accessToken: JWT;
        };
        credentials?: {
          accessKeyId: string;
          secretAccessKey: string;
          sessionToken?: string;
          expiration?: Date;
        };
        identityId?: string;
        userSub?: string;
      }
      ```

    </div>
  </Columns>
</Accordion>

### Example

<Columns columns={2}>
  <div>
    **V5**
    
    ```
    import { Auth } from 'aws-amplify';

    const getAuthenticatedUser = async () => {
      const {
        username,
        signInUserSession: session,
        authenticationFlowType
      } = await Auth.currentUserPoolUser();
    }
    ```

  </div>
  <div>
    **V6**
    
    ```
    import {
      fetchAuthSession,
      getCurrentUser
    } from 'aws-amplify/auth';

    const getAuthenticatedUser = async () => {
      const {
        username,
        authFlowType: authenticationFlowType
      } = await getCurrentUser();

      // Note that session will no longer contain refreshToken and clockDrift
      const {
        tokens: session
      } = await fetchAuthSession();
    }
    ```

  </div>
</Columns>

## Auth.currentSession

**Note:** we no longer return `refreshToken` or `clockDrift` with the `AuthSession`. These values are used under the hood to refresh/validate the user session

```diff
-  import { Auth } from 'aws-amplify';
+  import { fetchAuthSession } from 'aws-amplify/auth';

-  Auth.currentSession: () => Promise<CognitoUserSession>;
+  fetchAuthSession: (options?: FetchAuthSessionOptions) => Promise<AuthSession>;
```

<Accordion title='Input' headingLevel='3'>
  <Columns columns={2}>
    <div>
      **V5**

      No input in v5

    </div>
    <div>
      **V6**
      
      ```
      options?: FetchAuthSessionOptions {
        forceRefresh?: boolean;
      }
      ```
    
    </div>
  </Columns>
</Accordion>

<Accordion title='Output' headingLevel='3'>
  <Columns columns={2}>
    <div>
      **V5**
      
      ```
      CognitoUserSession {
        idToken: string;
        refreshToken: string;
        accessToken: string;
        clockDrift: number;
      }
      ```

    </div>
    <div>
      **V6**
      
      ```
      AuthSession {
        tokens?: {
          idToken?: JWT;
          accessToken: JWT;
        };
        credentials?: {
          accessKeyId: string;
          secretAccessKey: string;
          sessionToken?: string;
          expiration?: Date;
        };
        identityId?: string;
        userSub?: string;
      }
      ```

    </div>
  </Columns>
</Accordion>

### Example

<Columns columns={2}>
  <div>
    **V5**
    
    ```
    import { Auth } from 'aws-amplify';

    const getSession = async () => {
      const {
        idToken,
        refreshToken,
        accessToken,
        clockDrift
      } = await Auth.currentSession();
    }
    ```

  </div>
  <div>
    **V6**
    
    ```
    import { fetchAuthSession } from 'aws-amplify/auth';

    const getSession = async () => {
      const {
        tokens,
        credentials,
        identityId,
        userSub
      } = await fetchAuthSession();

      const {
        idToken,
        accessToken
      } = tokens;
    }
    ```

  </div>
</Columns>

## Auth.userSession

**Note:** we no longer return `refreshToken` or `clockDrift` with the `AuthSession`. These values are used under the hood to refresh/validate the user session

```diff
-  import { Auth } from 'aws-amplify';
+  import { fetchAuthSession } from 'aws-amplify/auth';

-  Auth.userSession: (user: CognitoUser) => Promise<CognitoUserSession>;
+  fetchAuthSession: (options?: FetchAuthSessionOptions) => Promise<AuthSession>;
```

<Accordion title='Input' headingLevel='3'>
  <Columns columns={2}>
    <div>
      **V5**
      
      ```
      user: CognitoUser
      ```

    </div>
    <div>
      **V6**
      
      ```
      options?: FetchAuthSessionOptions {
        forceRefresh?: boolean;
      }
      ```

    </div>
  </Columns>
</Accordion>

<Accordion title='Output' headingLevel='3'>
  <Columns columns={2}>
    <div>
      **V5**
      
      ```
      CognitoUserSession {
        idToken: string;
        refreshToken: string;
        accessToken: string;
        clockDrift: number;
      }
      ```

    </div>
    <div>
      **V6**
      
      ```
      AuthSession {
        tokens?: {
          idToken?: JWT;
          accessToken: JWT;
        };
        credentials?: {
          accessKeyId: string;
          secretAccessKey: string;
          sessionToken?: string;
          expiration?: Date;
        };
        identityId?: string;
        userSub?: string;
      }
      ```

    </div>
  </Columns>
</Accordion>

### Example

<Columns columns={2}>
  <div>
    **V5**
    
    ```
    import { Auth } from 'aws-amplify';

    const getSession = async ({ user }) => {
      const {
        idToken,
        refreshToken,
        accessToken,
        clockDrift
      } = await Auth.userSession(user);
    }
    ```

  </div>
  <div>
    **V6**
    
    ```
    import { fetchAuthSession } from 'aws-amplify/auth';

    const getSession = async () => {
      const {
        tokens,
        credentials,
        identityId,
        userSub
      } = await fetchAuthSession();

      const {
        idToken,
        accessToken
      } = tokens;
    }
    ```

  </div>
</Columns>

## Auth.userAttributes

```diff
-  import { Auth } from 'aws-amplify';
+  import { fetchUserAttributes } from 'aws-amplify/auth';

-  Auth.userAttributes: (user: CognitoUser | any) => Promise<CognitoUserAttribute[]>;
+  fetchUserAttributes: () => Promise<FetchUserAttributesOutput>;
```

<Accordion title='Input' headingLevel='3'>
  <Columns columns={2}>
    <div>
      **V5**
      
      ```
      user: CognitoUser
      ```

    </div>
    <div>
      **V6**

      No input in v6

    </div>
  </Columns>
</Accordion>

<Accordion title='Output' headingLevel='3'>
  <Columns columns={2}>
    <div>
      **V5**
      
      ```
      CognitoUserAttribute[]: {
        Name: string;
        Value: string;
      }[]
      ```

    </div>
    <div>
      **V6**
      
      ```
      FetchUserAttributesOutput {
        [key: string]?: string;
      }
      ```

    </div>
  </Columns>
</Accordion>

### Example

<Columns columns={2}>
  <div>
    **V5**
    
    ```
    import { Auth } from 'aws-amplify';

    const getUserAttributes = async ({
      user
    }) => {
      // Note that return type has changed from array to object
      const attributes = await Auth.userAttributes(user);
      return attributes;
    }
    ```

  </div>
  <div>
    **V6**
    
    ```
    import { fetchUserAttributes } from 'aws-amplify/auth';

    const getUserAttributes = async ({ userAttributes }) => {
      // Note that return type has changed from array to object
      const attributes = await fetchUserAttributes();
    }
    ```

  </div>
</Columns>

## Auth.updateUserAttributes

```diff
-  import { Auth } from 'aws-amplify';
+  import { updateUserAttributes } from 'aws-amplify/auth';

-  Auth.updateUserAttributes: (user: CognitoUser | any, attributes: object, clientMetadata?: ClientMetaData) => Promise<string>;
+  updateUserAttributes: (input: UpdateUserAttributesInput) => Promise<UpdateUserAttributesOutput>;
```

<Accordion title='Input' headingLevel='3'>
  <Columns columns={2}>
    <div>
      **V5**
      
      ```
      user: CognitoUser
      attributes: object
      clientMetadata?: ClientMetaData {
        [key: string]: string;
      }
      ```

    </div>
    <div>
      **V6**
      
      ```
      input: UpdateUserAttributesInput {
        userAttributes: {
          [key: string]?: string;
        };
        options?: {
          clientMetadata?: ClientMetaData {
            [key: string]: string;
          }
        };
      }
      ```
    </div>
  </Columns>
</Accordion>

<Accordion title='Output' headingLevel='3'>
  <Columns columns={2}>
    <div>
      **V5**
      
      ```
      'SUCCESS'
      ```

    </div>
    <div>
      **V6**
      
      ```
      UpdateUserAttributesOutput {
        [authKey in UserAttributeKey]: {
          isUpdated: boolean;
          nextStep: {
            updateAttributeStep: 
              | 'CONFIRM_ATTRIBUTE_WITH_CODE'
              | 'DONE';
            codeDeliveryDetails?: {
              destination?: string;
              deliveryMedium?: 
                | 'EMAIL'
                | 'SMS'
                | 'PHONE'
                | 'UNKNOWN';
              attributeName?: UserAttributeKey;
            };
          };
        };
      }
      ```
    </div>
  </Columns>
</Accordion>

### Example

<Columns columns={2}>
  <div>
    **V5**
    
    ```
    import { Auth } from 'aws-amplify';

    const handleUpdateProfile = async ({
      user,
      attributes
    }) => {
      await Auth.updateUserAttributes(user, attributes);
    }
    ```

  </div>
  <div>
    **V6**
    
    ```
    import { updateUserAttributes } from 'aws-amplify/auth';

    const handleUpdateProfile = async ({ userAttributes }) => {
      // Results will now contain next steps for updated attributes
      const updateResults = await updateUserAttributes({
        userAttributes
      });
    }
    ```

  </div>
</Columns>

## Auth.deleteUserAttributes

```diff
-  import { Auth } from 'aws-amplify';
+  import { deleteUserAttributes } from 'aws-amplify/auth';

-  Auth.deleteUserAttributes: (user: CognitoUser | any, attributeNames: string[]) => Promise<any>;
+  deleteUserAttributes: (input: DeleteUserAttributesInput) => Promise<void>;
```

<Accordion title='Input' headingLevel='3'>
  <Columns columns={2}>
    <div>
      **V5**
      
      ```
      user: CognitoUser
      attributeNames: string[]
      ```

    </div>
    <div>
      **V6**
      
      ```
      input: DeleteUserAttributesInput {
        userAttributeKeys: [UserAttributeKey, ...UserAttributeKey[]];
      }
      ```

    </div>
  </Columns>
</Accordion>

<Accordion title='Output' headingLevel='3'>
  <Columns columns={2}>
    <div>
      **V5**
      
      ```
      'SUCCESS'
      ```

    </div>
    <div>
      **V6**

      No output in v6

    </div>
  </Columns>
</Accordion>

### Example

<Columns columns={2}>
  <div>
    **V5**
    
    ```
    import { Auth } from 'aws-amplify';

    const handleDeleteAttributes = async ({ user, attributes }) => {
      await Auth.deleteUserAttributes(
        user,
        attributes
      );
    }
    ```

  </div>
  <div>
    **V6**
    
    ```
    import { deleteUserAttributes } from 'aws-amplify/auth';

    const handleDeleteAttributes = async ({ attributes }) => {
      await deleteUserAttributes({
        userAttributeKeys: attributes
      });
    }
    ```

  </div>
</Columns>

## Auth.verifyUserAttribute

```diff
-  import { Auth } from 'aws-amplify';
+  import { sendUserAttributeVerificationCode } from 'aws-amplify/auth';

-  Auth.verifyUserAttribute: (user: CognitoUser | any, attr: string, clientMetadata?: ClientMetaData) => Promise<void>;
+  sendUserAttributeVerificationCode: (input: SendUserAttributeVerificationCodeInput) => Promise<SendUserAttributeVerificationCodeOutput>;
```

<Accordion title='Input' headingLevel='3'>
  <Columns columns={2}>
    <div>
      **V5**
      
      ```
      user: CognitoUser
      attr: string
      clientMetadata?: ClientMetadata {
        [key: string]: string;
      }
      ```

    </div>
    <div>
      **V6**
      
      ```
      input: SendUserAttributeVerificationCodeInput {
        userAttributeKey: 'email' | 'phone_number';
        options?: {
          clientMetadata?: {
            [key: string]: string;
          };
        };
      }
      ```

    </div>
  </Columns>
</Accordion>

<Accordion title='Output' headingLevel='3'>
  <Columns columns={2}>
    <div>
      **V5**

      No output in v5

    </div>
    <div>
      **V6**
      
      ```
      SendUserAttributeVerificationCodeOutput {
        destination?: string;
        deliveryMedium?:
          | 'EMAIL'
          | 'SMS'
          | 'PHONE'
          | 'UNKNOWN';
        attributeName?: 'email' | 'phone_number';
      }
      ```
    
    </div>
  </Columns>
</Accordion>

### Example

<Columns columns={2}>
  <div>
    **V5**
    
    ```
    import { Auth } from 'aws-amplify';

    const handleVerifyAttribute = async ({
      user,
      attr,
      clientMetadata
    }) => {
      await Auth.verifyUserAttribute(
        user,
        attr,
        clientMetadata
      );
    }
    ```

  </div>
  <div>
    **V6**
    
    ```
    import { sendUserAttributeVerificationCode } from 'aws-amplify/auth';

    const handleVerifyAttribute = async ({
      userAttributeKey,
      clientMetadata
    }) => {
      const result = await sendUserAttributeVerificationCode({
        userAttributeKey,
        options: {
          clientMetadata
        }
      });
    }
    ```

  </div>
</Columns>

## Auth.verifyUserAttributeSubmit

```diff
-  import { Auth } from 'aws-amplify';
+  import { confirmUserAttribute } from 'aws-amplify/auth';

-  Auth.verifyUserAttributeSubmit: (user: CognitoUser | any, attr: string, code: string) => Promise<string>;
+  confirmUserAttribute: (input: ConfirmUserAttributeInput) => Promise<void>;
```

<Accordion title='Input' headingLevel='3'>
  <Columns columns={2}>
    <div>
      **V5**
      
      ```
      user: CognitoUser
      attr: string
      code: string
      ```

    </div>
    <div>
      **V6**
      
      ```
      input: ConfirmUserAttributeInput {
        userAttributeKey: 'email' | 'phone_number';
        confirmationCode: string;
      }
      ```

    </div>
  </Columns>
</Accordion>

<Accordion title='Output' headingLevel='3'>
  <Columns columns={2}>
    <div>
      **V5**

      ```
      'SUCCESS'
      ```

    </div>
    <div>
      **V6**

      No output in v6

    </div>
  </Columns>
</Accordion>

### Example

<Columns columns={2}>
  <div>
    **V5**
    
    ```
    import { Auth } from 'aws-amplify';

    const handleConfirmAttribute = async ({
      user,
      attr,
      code
    }) => {
      await Auth.verifyUserAttributeSubmit(
        user,
        attr,
        code
      );
    }
    ```

  </div>
  <div>
    **V6**
    
    ```
    import { confirmUserAttribute } from 'aws-amplify/auth';

    const handleConfirmAttribute = async ({
      userAttributeKey,
      confirmationCode
    }) => {
      await Auth.verifyUserAttributeSubmit(
        userAttributeKey,
        confirmationCode
      );
    }
    ```

  </div>
</Columns>

## Auth.verifyCurrentUserAttribute

```diff
-  import { Auth } from 'aws-amplify';
+  import { sendUserAttributeVerificationCode } from 'aws-amplify/auth';

-  Auth.verifyCurrentUserAttribute: (attr: string) => Promise<void>;
+  sendUserAttributeVerificationCode: (input: SendUserAttributeVerificationCodeInput) => Promise<SendUserAttributeVerificationCodeOutput>;
```

<Accordion title='Input' headingLevel='3'>
  <Columns columns={2}>
    <div>
      **V5**
      
      ```
      attr: string
      ```

    </div>
    <div>
      **V6**
      
      ```
      input: SendUserAttributeVerificationCodeInput {
        userAttributeKey: 'email' | 'phone_number';
        options?: {
          clientMetadata?: {
            [key: string]: string;
          };
        };
      }
      ```
    
    </div>
  </Columns>
</Accordion>

<Accordion title='Output' headingLevel='3'>
  <Columns columns={2}>
    <div>
      **V5**

      No output in v5

    </div>
    <div>
      **V6**
      
      ```
      SendUserAttributeVerificationCodeOutput {
        destination?: string;
        deliveryMedium?:
          | 'EMAIL'
          | 'SMS'
          | 'PHONE'
          | 'UNKNOWN';
        attributeName?: 'email' | 'phone_number';
      }
      ```
    </div>
  </Columns>
</Accordion>

### Example

<Columns columns={2}>
  <div>
    **V5**
    
    ```
    import { Auth } from 'aws-amplify';

    const handleVerifyAttribute = async ({
      attr
    }) => {
      await Auth.verifyCurrentUserAttribute(attr);
    }
    ```

  </div>
  <div>
    **V6**
    
    ```
    import { sendUserAttributeVerificationCode } from 'aws-amplify/auth';

    const handleVerifyAttribute = async ({
      userAttributeKey
    }) => {
      const result = await sendUserAttributeVerificationCode({
        userAttributeKey
      });
    }
    ```

  </div>
</Columns>

## Auth.verifyCurrentUserAttributeSubmit

```diff
-  import { Auth } from 'aws-amplify';
+  import { confirmUserAttribute } from 'aws-amplify/auth';

-  Auth.verifyCurrentUserAttributeSubmit(attr: string, code: string) => Promise<string>;
+  confirmUserAttribute: (input: ConfirmUserAttributeInput) => Promise<void>;
```

<Accordion title='Input' headingLevel='3'>
  <Columns columns={2}>
    <div>
      **V5**
      
      ```
      attr: string
      code: string
      ```

    </div>
    <div>
      **V6**
      
      ```
      input: ConfirmUserAttributeInput {
        userAttributeKey: 'email' | 'phone_number';
        confirmationCode: string;
      }
      ```
    </div>
  </Columns>
</Accordion>

<Accordion title='Output' headingLevel='3'>
  <Columns columns={2}>
    <div>
      **V5**
      
      ```
      'SUCCESS'
      ```
      
    </div>
    <div>
      **V6**

      No output in v6

    </div>
  </Columns>
</Accordion>

### Example

<Columns columns={2}>
  <div>
    **V5**
    
    ```
    import { Auth } from 'aws-amplify';

    const handleConfirmAttribute = async ({
      attr,
      code
    }) => {
      await Auth.verifyCurrentUserAttributeSubmit(
        attr,
        code
      );
    }
    ```

  </div>
  <div>
    **V6**
    
    ```
    import { confirmUserAttribute } from 'aws-amplify/auth';

    const handleConfirmAttribute = async ({
      userAttributeKey,
      confirmationCode
    }) => {
      await Auth.verifyUserAttributeSubmit(
        userAttributeKey,
        confirmationCode
      );
    }
    ```

  </div>
</Columns>

## Auth.rememberDevice

```diff
-  import { Auth } from 'aws-amplify';
+  import { rememberDevice } from 'aws-amplify/auth';

-  Auth.rememberDevice: () => Promise<string | AuthError>;
+  rememberDevice: () => Promise<void>;
```

<Accordion title='Output' headingLevel='3'>
  <Columns columns="2">
    <div>
      **V5**
      
      ```
      'SUCCESS'
      ```
      
    </div>
    <div>
      **V6**

      No output in v6

    </div>
  </Columns>
</Accordion>

### Example

<Columns columns="2">
  <div>
    **V5**
    
    ```
    import { Auth } from 'aws-amplify';

    const handleRememberDevice = async () => {
      await Auth.rememberDevice();
    }
    ```

  </div>
  <div>
    **V6**
    
    ```
    import { rememberDevice } from 'aws-amplify/auth';

    const handleRememberDevice = async () => {
      await rememberDevice();
    }
    ```

  </div>
</Columns>

## Auth.forgetDevice

```diff
-  import { Auth } from 'aws-amplify';
+  import { forgetDevice } from 'aws-amplify/auth';

-  Auth.forgetDevice: () => Promise<void>;
+  forgetDevice: (input?: ForgetDeviceInput) => Promise<void>;
```

<Accordion title='Input' headingLevel='3'>
  <Columns columns="2">
    <div>
      **V5**

      No input in v5

    </div>
    <div>
      **V6**
      
      ```
      input?: ForgetDeviceInput {
        device?: {
          id: string;
        }
      }
      ```

    </div>
  </Columns>
</Accordion>

### Example

<Columns columns="2">
  <div>
    **V5**
    
    ```
    import { Auth } from 'aws-amplify';

    const handleForgetDevice = async () => {
      await Auth.forgetDevice();
    }
    ```

  </div>
  <div>
    **V6**
    
    ```
    import { forgetDevice } from 'aws-amplify/auth';

    const handleForgetDevice = async () => {
      await forgetDevice();
    }
    ```

  </div>
</Columns>

## Auth.currentCredentials (DEPRECATED)

This API has been deprecated: existing use cases can be migrated to the `fetchAuthSession` API. Note that `fetchAuthSession` will throw an error if there is no authenticated user.

```diff
-  import { Auth } from 'aws-amplify';
+  import { fetchAuthSession } from 'aws-amplify/auth';

-  Auth.currentCredentials: () => Promise<ICredentials>;
+  fetchAuthSession: (options?: FetchAuthSessionOptions) => Promise<AuthSession>;
```

<Accordion title='Input' headingLevel='3'>
  <Columns columns={2}>
    <div>
      **V5**

      No input in v5

    </div>
    <div>
      **V6**
      
      ```
      options?: FetchAuthSessionOptions {
        forceRefresh?: boolean;
      }
      ```

    </div>
  </Columns>
</Accordion>

<Accordion title='Output' headingLevel='3'>
  <Columns columns={2}>
    <div>
      **V5**
      
      ```
      ICredentials {
        accessKeyId: string;
        sessionToken: string;
        secretAccessKey: string;
        identityId: string;
        authenticated: boolean;
        expiration?: Date;
      }
      ```

    </div>
    <div>
      **V6**
      
      ```
      AuthSession {
        tokens?: {
          idToken?: JWT;
          accessToken: JWT;
        };
        credentials?: {
          accessKeyId: string;
          secretAccessKey: string;
          sessionToken?: string;
          expiration?: Date;
        };
        identityId?: string;
        userSub?: string;
      }
      ```

    </div>
  </Columns>
</Accordion>

### Example

<Columns columns={2}>
  <div>
    **V5**
    
    ```
    import { Auth } from 'aws-amplify';

    const getSession = async () => {
      const {
        accessKeyId,
        sessionToken,
        secretAccessKey,
        identityId,
        authenticated,
        expiration
      } = await Auth.currentCredentials();
    }
    ```

  </div>
  <div>
    **V6**
    
    ```
    import { fetchAuthSession } from 'aws-amplify/auth';

    const getSession = async () => {
      try {
        const {
            tokens,
            credentials,
            identityId,
            userSub
        } = await fetchAuthSession();

        const {
            accessKeyId,
            sessionToken,
            secretAccessKey,
            expiration
        } = credentials;

        const authenticated = true;
      } catch(e) {
        if (e.name === 'UserUnAuthenticatedException') {
          const authenticated = false;
        }
      }
    }
    ```

  </div>
</Columns>

## Auth.currentUserCredentials (DEPRECATED)

This API has been deprecated: existing use cases can be migrated to the `fetchAuthSession` API. Note that `fetchAuthSession` will throw an error if there is no authenticated user.

```diff
-  import { Auth } from 'aws-amplify';
+  import { fetchAuthSession } from 'aws-amplify/auth';

-  Auth.currentUserCredentials: () => Promise<ICredentials>;
+  fetchAuthSession: (options?: FetchAuthSessionOptions) => Promise<AuthSession>;
```

<Accordion title='Input' headingLevel='3'>
  <Columns columns={2}>
    <div>
      **V5**

      No input in v5

    </div>
    <div>
      **V6**
      
      ```
      options?: FetchAuthSessionOptions {
        forceRefresh?: boolean;
      }
      ```
    
    </div>
  </Columns>
</Accordion>

<Accordion title='Output' headingLevel='3'>
  <Columns columns={2}>
    <div>
      **V5**
      
      ```
      ICredentials {
        accessKeyId: string;
        sessionToken: string;
        secretAccessKey: string;
        identityId: string;
        authenticated: boolean;
        expiration?: Date;
      }
      ```

    </div>
    <div>
      **V6**
      
      ```
      AuthSession {
        tokens?: {
          idToken?: JWT;
          accessToken: JWT;
        };
        credentials?: {
          accessKeyId: string;
          secretAccessKey: string;
          sessionToken?: string;
          expiration?: Date;
        };
        identityId?: string;
        userSub?: string;
      }
      ```
    </div>
  </Columns>
</Accordion>

### Example

<Columns columns={2}>
  <div>
    **V5**
    
    ```
    import { Auth } from 'aws-amplify';

    const getSession = async () => {
      const {
        accessKeyId,
        sessionToken,
        secretAccessKey,
        identityId,
        authenticated,
        expiration
      } = await Auth.currentUserCredentials();
    }
    ```

  </div>
  <div>
    **V6**
    
    ```
    import { fetchAuthSession } from 'aws-amplify/auth';

    const getSession = async () => {
      try {
        const {
            tokens,
            credentials,
            identityId,
            userSub
        } = await fetchAuthSession();

        const {
            accessKeyId,
            sessionToken,
            secretAccessKey,
            expiration
        } = credentials;

        const authenticated = true;
      } catch(e) {
        if (e.name === 'UserUnAuthenticatedException') {
          const authenticated = false;
        }
      }
    }
    ```

  </div>
</Columns>

## Auth.currentUserInfo (DEPRECATED)

This API has been deprecated: existing use cases can be migrated by using a combination of `getCurrentUser` and `fetchUserAttributes` APIs.

```diff
-  import { Auth } from 'aws-amplify';
+  import { fetchUserAttributes, getCurrentUser } from 'aws-amplify/auth';

-  Auth.currentUserInfo: () => Promise<any>;
+  getCurrentUser: () => Promise<GetCurrentUserOutput>;
+  fetchUserAttributes: () => Promise<FetchUserAttributesOutput>;
```

<Accordion title='Input' headingLevel='3'>
  <Columns columns="2">
    <div>
      **V5**
      
      ```
      {
        id?: string;
        username: string;
        attributes: {
          [key: string]: string;
        };
      }
      ```
    
    </div>
    <div>
      **V6**
      
      ```
      // getCurrentUser
      GetCurrentUserOutput: {
        username: string;
        userId: string;
        signInDetails?: {
          loginId?: string;
          authFlowType?: 
            | 'USER_SRP_AUTH'
            | 'CUSTOM_WITH_SRP'
            | 'CUSTOM_WITHOUT_SRP'
            | 'USER_PASSWORD_AUTH';;
        };
      }

      // fetchUserAttributes
      FetchUserAttributesOutput {
        [key: string]?: string;
      }
      ```

    </div>
  </Columns>
</Accordion>

### Example

<Columns columns="2">
  <div>
    **V5**
    
    ```
    import { Auth } from 'aws-amplify';

    const getCurrentUserInfo = async () => {
      return await Auth.currentUserInfo();
    }
    ```

  </div>
  <div>
    **V6**
    
    ```
    import { getCurrentUser, fetchUserAttributes } from 'aws-amplify';

    const getCurrentUserInfo = async () => {
      const {
        username,
        userId: id
      } = await getCurrentUser();

      const attributes = fetchUserAttributes();

      return {
        id,
        username,
        attributes
      };
    }
    ```

  </div>
</Columns>

## Auth.essentialCredentials (DEPRECATED)

This API has been deprecated and there is no parallel method for `essentialCredentials` in v6. See [Auth.currentUserCredentials](/[platform]/build-a-backend/auth/auth-migration-guide/#authcurrentusercredentials-deprecated) for details on retrieving credentials using `fetchAuthSession`

## Auth.verifiedContact (DEPRECATED)

This API has been deprecated: existing use cases can be migrated to the `fetchUserAttributes` API using `output.email_verified` and `output.phone_number_verified` attributes.

```diff
-  import { Auth } from 'aws-amplify';
+  import { fetchUserAttributes } from 'aws-amplify/auth';

-  Auth.verifiedContact: (user: CognitoUser | any) => Promise<any>;
+  fetchUserAttributes: () => Promise<FetchUserAttributesOutput>;
```

<Accordion title='Input' headingLevel='3'>
  <Columns columns={2}>
    <div>
      **V5**
      
      ```
      user: CognitoUser
      ```
      
    </div>
    <div>
      **V6**

      No input in v6

    </div>
  </Columns>
</Accordion>

<Accordion title='Output' headingLevel='3'>
  <Columns columns={2}>
    <div>
      **V5**
      
      ```
      {
        verified: {
          email?: boolean;
          phone_number?: boolean;
        },
        unverified: {
          email?: boolean;
          phone_number?: boolean;
        }
      }
      ```

    </div>
    <div>
      **V6**

      ```
      FetchUserAttributesOutput {
        [key: string]?: string;
      }
      ```

    </div>
  </Columns>
</Accordion>

### Example

<Columns columns={2}>
  <div>
    **V5**
    
    ```
    import { Auth } from 'aws-amplify';

    const checkAttributeVerification = await ({ user }) => {
      const {
        verified,
        unverified
      } = await Auth.verifiedContact(user);
    }
    ```

  </div>
  <div>
    **V6**
    
    ```
    import { fetchUserAttributes } from 'aws-amplify/auth';

    const checkAttributeVerification = await () => {
      const attributes = await fetchUserAttributes();

      const emailVerified = isTruthyString(attributes.email_verified);
      const phoneVerified = isTruthyString(attributes.phone_number_verified);
    }

    const isTruthyString = (value) => {
      return (
        value && typeof value.toLowerCase === 'function' && value.toLowerCase() === 'true'
      );
    }
    ```

  </div>
</Columns>

## Auth.disableSMS (DEPRECATED)

This API has been deprecated: existing use cases can be migrated to the `updateMFAPreference` API

```diff
-  import { Auth } from 'aws-amplify';
+  import { updateMFAPreference } from 'aws-amplify/auth';

-  Auth.disableSMS: (user: CognitoUser) => Promise<string>;
+  updateMFAPreference: (input: UpdateMFAPreferenceInput) => Promise<void>;
```

<Accordion title='Input' headingLevel='3'>
  <Columns columns={2}>
    <div>
      **V5**
      
      ```
      user: CognitoUser
      ```

    </div>
    <div>
      **V6**
      
      ```
      input: UpdateMFAPreferenceInput {
        sms?:
          | 'ENABLED'
          | 'DISABLED'
          | 'PREFERRED'
          | 'NOT_PREFERRED'
        mfa?:
          | 'ENABLED'
          | 'DISABLED'
          | 'PREFERRED'
          | 'NOT_PREFERRED'
      }
      ```

    </div>
  </Columns>
</Accordion>

<Accordion title='Output' headingLevel='3'>
  <Columns columns={2}>
    <div>
      **V5**
      
      ```
      'SUCCESS'
      ```
    
    </div>
    <div>
      **V6**

      No output in v6

    </div>
  </Columns>
</Accordion>

### Example

<Columns columns={2}>
  <div>
    **V5**
    
    ```
    import { Auth } from 'aws-amplify';

    const handleDisableSMS = async ({ user }) => {
      await Auth.disableSMS(user);
    }
    ```

  </div>
  <div>
    **V6**
    
    ```
    import { updateMFAPreference } from 'aws-amplify/auth';

    const handleDisableSMS = async () => {
      await updateMFAPreference({ sms: 'DISABLED' });
    }
    ```

  </div>
</Columns>

## Auth.enableSMS (DEPRECATED)

This API has been deprecated: existing use cases can be migrated to the `updateMFAPreference` API

```diff
-  import { Auth } from 'aws-amplify';
+  import { updateMFAPreference } from 'aws-amplify/auth';

-  Auth.enableSMS: (user: CognitoUser) => Promise<string>;
+  updateMFAPreference: (input: UpdateMFAPreferenceInput) => Promise<void>;
```

<Accordion title='Input' headingLevel='3'>
  <Columns columns={2}>
    <div>
      **V5**
      
      ```
      user: CognitoUser
      ```

    </div>
    <div>
      **V6**
      
      ```
      input: UpdateMFAPreferenceInput {
        sms?:
          | 'ENABLED'
          | 'DISABLED'
          | 'PREFERRED'
          | 'NOT_PREFERRED'
        mfa?:
          | 'ENABLED'
          | 'DISABLED'
          | 'PREFERRED'
          | 'NOT_PREFERRED'
      }
      ```

    </div>
  </Columns>
</Accordion>

<Accordion title='Output' headingLevel='3'>
  <Columns columns={2}>
    <div>
      **V5**
      
      ```
      'SUCCESS'
      ```

    </div>
    <div>
      **V6**

      No output in v6

    </div>
  </Columns>
</Accordion>

### Example

<Columns columns={2}>
  <div>
    **V5**
    
    ```
    import { Auth } from 'aws-amplify';

    const handleEnableSMS = async ({ user }) => {
      const result = await Auth.enableSMS(user);
    }
    ```

  </div>
  <div>
    **V6**
    
    ```
    import { updateMFAPreference } from 'aws-amplify/auth';

    const handleEnableSMS = async () => {
      await updateMFAPreference({sms: 'ENABLED'});
    }
    ```

  </div>
</Columns>
