import { getCustomStaticPath } from '@/utils/getCustomStaticPath';

export const meta = {
  title: 'Set up an Amplify Function',
  description:
    'Use AWS Lambda functions to perform tasks and customize workflows.',
  platforms: [
    'android',
    'angular',
    'flutter',
    'javascript',
    'nextjs',
    'react',
    'react-native',
    'swift',
    'vue'
  ]
};

export function getStaticPaths() {
  return getCustomStaticPath(meta.platforms);
}

export function getStaticProps(context) {
  return {
    props: {
      meta
    }
  };
}

Amplify Functions are powered by [AWS Lambda](https://aws.amazon.com/lambda/), and allow you to perform a wide variety of customization through contained _functions_.

## Define a Function

To get started, create a new directory and a resource file, `amplify/functions/my-demo-function/resource.ts`. Then, define the Function with `defineFunction`:

```ts title="amplify/functions/my-demo-function/resource.ts"
import { defineFunction } from '@aws-amplify/backend';

export const myDemoFunction = defineFunction({
  // optionally specify a name for the Function (defaults to directory name)
  name: 'my-demo-function',
  // optionally specify a path to your handler (defaults to "./handler.ts")
  entry: './handler.ts'
});
```

Next, create the corresponding handler file at `amplify/functions/my-demo-function/handler.ts`. This is where your function code will go.

```ts title="amplify/functions/my-demo-function/handler.ts"
export const handler = async (event) => {
  // your function code goes here
  return 'You made a function!';
};
```

The handler file _must_ export an async function named "handler". This is the entry point to your function. For more information on writing functions, refer to the [AWS documentation for Lambda function handlers using Node.js](https://docs.aws.amazon.com/lambda/latest/dg/nodejs-handler.html).

Lastly, this function needs to be added to your backend.

```ts title="amplify/backend.ts"
import { defineBackend } from '@aws-amplify/backend';
// highlight-next-line
import { myDemoFunction } from './functions/my-demo-function/resource';

defineBackend({
  // highlight-next-line
  myDemoFunction
});
```

Now when you run `npx amplify sandbox` or deploy your app on Amplify, it will include your backend function. See the [examples](../examples/) below for connecting your functions to event sources.

## Next steps

Now that you have completed setting up your first Function, you may also want to add some additional features or modify a few settings. We recommend you learn more about:

- [Environment variables and secrets](../environment-variables-and-secrets/)
- [Grant access to other resources](../grant-access-to-other-resources/)
- [Explore example use cases](../examples/)
- [Modifying underlying resources with CDK](../modify-resources-with-cdk/)
