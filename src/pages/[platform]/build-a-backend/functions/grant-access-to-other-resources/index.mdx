import { getCustomStaticPath } from '@/utils/getCustomStaticPath';

export const meta = {
  title: 'Grant access to other resources',
  description:
    'Extend the capabilities of your Function by granting access to other resources',
  platforms: [
    'android',
    'angular',
    'flutter',
    'javascript',
    'nextjs',
    'react',
    'react-native',
    'swift',
    'vue'
  ]
};

export function getStaticPaths() {
  return getCustomStaticPath(meta.platforms);
}

export function getStaticProps() {
  return {
    props: {
      meta
    }
  };
}

When you grant a function access to another resource in your Amplify backend ([such as granting access to storage](/[platform]/build-a-backend/storage/#resource-access)), that will configure environment variables for that function to make SDK calls to the AWS services it has access to. Those environment variables are typed and available as part of the `env` object.

Example `defineStorage` that grants myDemoFunction access to files in `/foo/*`.

```ts title="amplify/storage/resource.ts"
import { myDemoFunction } from '../functions/my-demo-function/resource';

export const storage = defineStorage({
  name: 'myProjectFiles',
  access: (allow) => ({
    '/foo/*': [allow.resource(demoFunction).to(['read', 'write', 'delete'])]
  })
});
```

This access definition will add the environment variable `myProjectFiles_BUCKET_NAME` to the function. This environment variable can be accessed on the `env` object.

Here's an example of how it can be used to upload some content to S3.

```ts title="amplify/functions/my-demo-function/handler.ts"
import { env } from '$amplify/env/my-demo-function';
import { S3Client, PutObjectCommand } from '@aws-sdk/client-s3';

const s3Client = new S3Client();

export const handler = async (event) => {
  await s3Client.send(
    new PutObjectCommand({
      Bucket: env.myProjectFiles_BUCKET_NAME,
      Key: 'foo/someFile.txt',
      Body: 'this is an example'
    })
  );
};
```
