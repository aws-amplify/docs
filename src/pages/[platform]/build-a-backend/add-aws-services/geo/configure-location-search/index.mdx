import { getCustomStaticPath } from '@/utils/getCustomStaticPath';
                  
export const meta = {
  title: 'Configure location search',
  description: 'Create and manage location search indices or place indices that are used to search for places in your application.',
  platforms: [
    'android',
    'angular',
    'javascript',
    'nextjs',
    'react',
    'swift',
    'vue'
  ],
};

export const getStaticPaths = async () => {
  return getCustomStaticPath(meta.platforms);
};

export function getStaticProps(context) {
  return {
    props: {
      platform: context.params.platform,
      meta
    }
  };
}
          
Amplify's `geo` category enables you to search by places, addresses, and coordinates in your app with "place index" resources. These resources also include an API key with access restrictions specified from the `access` callback. This API key will be used to render the location search components if your application requires access control on the components. To set up or learn more about Amazon Location API keys, visit the [developer guide](https://docs.aws.amazon.com/location/latest/developerguide/using-apikeys.html).

## Setup a new Location Search Index

```ts title="amplify/geo/resource.ts"
import { definePlace } from "@aws-amplify/backend-geo";

export const searchIndex = definePlace({
  name: 'amplfyPlace',
  description: 'This is an Amplify search index.',
  access: (allow) => [
    allow.authenticated.to(['autocomplete', 'geocode']),
    allow.guest.to(['autocomplete', 'geocode']),
    allow.apiKey.to(['search'])
  ],
  apiKeyProps: {
    apiKeyName: 'amplifyPlaceIndexKey'
  }
});
```

Now update your `backend.ts` file with the place index created in your `resource.ts` file.

```ts title="amplify/backend.ts"
import { defineBackend } from "@aws-amplify/backend";
import { auth } from "./auth/resource";
import { data } from "./data/resource";
// highlight-next-line
import { searchIndex } from "./geo/resource";

const backend = defineBackend({
  auth,
  data,
  // highlight-next-line
  searchIndex
});
```

## Location Search Index Pricing Plan
The pricing plan for Search Index will be set to `RequestBasedUsage`.
We advice you to go through the [location service pricing](https://aws.amazon.com/location/pricing/) along with the [location service terms](https://aws.amazon.com/service-terms/) (_82.5 section_) to learn more about the pricing plan.


{/* MOVE THIS TO LEGACY RESOURCES PAGE */}
{/* ## Advanced Settings
You can optionally configure the data provider and result storage location for your location search index.

### Location Search data provider
You can select a data provider as the source for geocoding, reverse geocoding and searches.
Each provider gathers and curates their data using different means. They may also have varying expertise in different regions of the world.
The available data providers of geospatial data are shown. To learn more about data providers, please refer this [location service documentation](https://docs.aws.amazon.com/location/latest/developerguide/what-is-data-provider.html).

- Here – For additional information about HERE Technologies, see [Here guide](https://docs.aws.amazon.com/location/latest/developerguide/HERE.html).
- Esri – For additional information about Esri, see [Esri guide](https://docs.aws.amazon.com/location/latest/developerguide/esri.html).

<Callout>

**Note:** If your application is tracking or routing assets you use in your business (such as delivery vehicles or employees), you may only use `HERE` as your geolocation provider. 
See section 82 of the [AWS service terms](https://aws.amazon.com/service-terms/) for more details.

</Callout>

### Location Search result storage location
You can specify how the results of a search operation will be stored by the caller.

- SingleUse - specifies that the results won't be stored.
- Storage - specifies that the result can be cached or stored in a database.

Refer [this location service doc](https://docs.aws.amazon.com/location-places/latest/APIReference/API_DataSourceConfiguration.html#locationplaces-Type-DataSourceConfiguration-IntendedUse) for more information. */}
