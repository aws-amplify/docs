import { getCustomStaticPath } from '@/utils/getCustomStaticPath';

export const meta = {
  title: 'Update data',
  description: 'Using Post, Put, etc. in Amplify',
  platforms: [
    'javascript',
    'react-native',
    'flutter',
    'swift',
    'android',
    'angular',
    'nextjs',
    'react',
    'vue'
  ],
};

export const getStaticPaths = async () => {
  return getCustomStaticPath(meta.platforms);
};

export function getStaticProps(context) {
  return {
    props: {
      platform: context.params.platform,
      meta
    }
  };
}

<InlineFilter filters={['javascript', "angular", "react", "vue", "react-native", "nextjs"]}>
## PUT data

To create or update a item via the API endpoint:

```javascript
import { put } from 'aws-amplify/api';

async function updateTodo() {
  try {
    const Item = { name: 'My first Item', message: 'Hello world!' };
    const restOperation = put({
      apiName: 'myRestApi',
      path: 'items/1',
      options: {
        body: Item
      }
    });
    const response = await restOperation.response;
    console.log('PUT call succeeded: ', response);
  } catch (e) {
    console.log('PUT call failed: ', JSON.parse(e.response.body));
  }
}
```
</InlineFilter>

<InlineFilter filters={['swift']}>
## Update data

Put data to the API endpoint:

<BlockSwitcher>

<Block name="Async/Await">

```swift
func putTodo() async {
    let updatedMessage = #"{"message": "my updated Todo"}"#
    let request = RESTRequest(path: "items", body: updatedMessage.data(using: .utf8))
    do {
        let data = try await Amplify.API.put(request: request)
        let str = String(decoding: data, as: UTF8.self)
        print("Success: \(str)")
    } catch let error as APIError {
        print("Failed due to API error: ", error)
    } catch {
        print("Unexpected error: \(error)")
    }
}
```

</Block>

<Block name="Combine">

```swift
func putTodo() -> AnyCancellable {
    let updatedMessage = #"{"message": "my updated Todo"}"#
    let request = RESTRequest(path: "items", body: updatedMessage.data(using: .utf8))
    let sink = Amplify.Publisher.create {
        try await Amplify.API.put(request: request)
    }
    .sink {
        if case let .failure(apiError) = $0 {
            print("Failed", apiError)
        }
    }
    receiveValue: { data in
        let str = String(decoding: data, as: UTF8.self)
        print("Success \(str)")
    }
    return sink
}
```

</Block>

</BlockSwitcher>
</InlineFilter>

<InlineFilter filters={['android']}>
## PUT requests

To update an item via the API endpoint:

<BlockSwitcher>
<Block name="Java">

```java
RestOptions options = RestOptions.builder()
    .addPath("items/1")
    .addBody("{\"name\":\"Mow the lawn\"}".getBytes())
    .build();

Amplify.API.put(options,
    response -> Log.i("MyAmplifyApp", "PUT succeeded: " + response),
    error -> Log.e("MyAmplifyApp", "PUT failed.", error)
);
```

</Block>
<Block name="Kotlin - Callbacks">

```kotlin
val request = RestOptions.builder()
    .addPath("items/1")
    .addBody("{\"name\":\"Mow the lawn\"}".toByteArray())
    .build()

Amplify.API.put(request,
    { Log.i("MyAmplifyApp", "PUT succeeded: $it") },
    { Log.e("MyAmplifyApp", "PUT failed", it) }
)
```

</Block>
<Block name="Kotlin - Coroutines">

```kotlin
val request = RestOptions.builder()
    .addPath("items/1")
    .addBody(JSONObject()
        .put("name", "Mow the lawn")
        .toString()
        .toByteArray())
    .build()
try {
    val response = Amplify.API.put(request)
    Log.i("MyAmplifyApp", "PUT succeeded: $response")
} catch (error: ApiException) {
    Log.e("MyAmplifyApp", "PUT failed", it)
}
```

</Block>
<Block name="RxJava">

```java
RestOptions options = RestOptions.builder()
    .addPath("items/1")
    .addBody("{\"name\":\"Mow the lawn\"}".getBytes())
    .build();

RxAmplify.API.put(options)
    .subscribe(
          response -> Log.i("MyAmplifyApp", "PUT succeeded: " + response),
          error -> Log.e("MyAmplifyApp", "PUT failed.", error)
    );
```

</Block>
</BlockSwitcher>
</InlineFilter>

<InlineFilter filters={['flutter']}>
## PUT requests

To update an item via the API endpoint:


```dart
Future<void> updateTodo() async {
  try {
    final restOperation = Amplify.API.put(
      'items/1',
      body: HttpPayload.json({'name': 'Mow the lawn'}),
    );
    final response = await restOperation.response;
    print('PUT call succeeded');
    print(response.decodeBody());
  } on ApiException catch (e) {
    print('PUT call failed: $e');
  }
}
```
</InlineFilter>
