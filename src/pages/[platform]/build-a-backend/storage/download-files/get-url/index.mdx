import { getCustomStaticPath } from '@/utils/getCustomStaticPath';

export const meta = {
  title: 'Get URL',
  description: 'Download files using Amplify Storage',
  platforms: [
    'angular',
    'javascript',
    'nextjs',
    'react',
    'vue'
  ]
};

export const getStaticPaths = async () => {
  return getCustomStaticPath(meta.platforms);
};

export function getStaticProps(context) {
  return {
    props: {
      meta
    }
  };
}

Get a presigned URL of a stored file and expiration of URL

```typescript
import { getUrl } from 'aws-amplify/storage';

const getUrlResult = await getUrl({
  path: "album/2024/1.jpg",
  // Alternatively, path: ({identityId}) => `album/{identityId}/1.jpg`
  options: {
    validateObjectExistence?: false,  // defaults to false
    expiresIn?: 20 // validity of the URL, in seconds. defaults to 900 (15 minutes) and maxes at 3600 (1 hour)
    useAccelerateEndpoint: true; // Whether to use accelerate endpoint.
  },
});
console.log('signed URL: ', getUrlResult.url);
console.log('URL expires at: ', getUrlResult.expiresAt);
```

`getUrl` returns a signed URL in the `url` property of the result. You can use this to create a download link for users to click on. The `expiresAt` property is a `Date` object that represents the time at which the URL will expire.

Inside your template or JSX code, you can use the `url` property to create a link to the file:

```tsx
<a href={signedURL.url.toString()} target="_blank" rel="noreferrer">
  {fileName} 
</a>

<Callout>

This function does not check if the file exists by default. As result, the signed URL may fail if the file to be download does not exist.
  
</Callout>

### Check for existence of a file

You can check for the existence of a file in the storage category's `getUrl` API using the `validateObjectExistence` option. When this flag is enabled a `getUrl` call will return a pre-signed URL if the file exists and raise a `404` error if it does not. This allows you to check if an object exists during generating the presigned URL, which you can then use to download that object.

```javascript
import { getUrl } from 'aws-amplify/storage';

// To check for existence of a file
await getUrl({
  path: "album/2024/1.jpg",
  // Alternatively, path: ({identityId}) => `album/{identityId}/1.jpg`
  options: {
    validateObjectExistence: true // defaults to false
  }
});
```

### Set expiry for presigned URL

You can use `expiresIn` option to limit the availability of your URLs. This configuration returns the pre-signed URL that expires in 60 seconds:

```javascript
import { getUrl } from 'aws-amplify/storage';

await getUrl({ 
  path: "album/2024/1.jpg",
  // Alternatively, path: ({identityId}) => `album/{identityId}/1.jpg`
  options: { expiresIn: 60 } 
});
```
<Callout>
  The expiration time of the presigned url is dependent on the session and will
  max out at 1 hour.
</Callout>
