## Record Event

The Amplify Analytics plugin provides a simple interface to record custom events within your app:

import ios0 from "/src/fragments/lib/analytics/ios/record-event-code.mdx";

<Fragments fragments={{ios: ios0}} />

## Flush Events

By default, events are automatically flushed out to the network every 60 seconds. 

If you would like to change this, update `amplifyconfiguration.json` and set the value you would prefer under `autoFlushEventsInterval`, expressed in seconds:

```json
{
    "UserAgent": "aws-amplify-cli/2.0",
    "Version": "1.0",
    "analytics": {
        "plugins": {
            "awsPinpointAnalyticsPlugin": {
                "pinpointAnalytics": {
                    "appId": "AppID",
                    "region": "Region",
                    "autoFlushEventsInterval": 60
                }
            }
        }
    }
}
```

> **Note**
>
> Setting `autoFlushEventsInterval` to 0 will **disable** the automatic flush of events and you will be responsible for submitting them.


To manually submit the recoded events to the backend, call:

```swift
Amplify.Analytics.flushEvents()
```

The plugin automatically batches requests in order to reduce network bandwidth and handles the retry logic if the device loses connectivity.

## Authentication events
Indicate how frequently users authenticate with your application.

On the **Analytics** page, the **Users** tab displays charts for **Sign-ins, Sign-ups, and Authentication failures**.

To learn how frequently users authenticate with your app, update your application code so that Pinpoint receives the following standard event types for authentication:

 - `_userauth.sign_in`
 - `_userauth.sign_up`
 - `_userauth.auth_fail`

You can report authentication events by doing either of the following:

 - Managing user sign-up and sign-in with Amazon Cognito user pools.

  Cognito user pools are user directories that make it easier to add sign-up and sign-in to your app. As users authenticate with your app, Cognito reports authentication events to Pinpoint. For more information, see [Using Amazon Pinpoint Analytics with Amazon Cognito User Pools](https://docs.aws.amazon.com/cognito/latest/developerguide/cognito-user-pools-pinpoint-integration.html) in the _Amazon Cognito Developer Guide_. Also update **amplifyconfiguration.json** by adding the `PinpointAppId` key under `CognitoUserPool`.

  ```json
  "CognitoUserPool": {
      "Default": {
          "PoolId": "<poolid>",
          "AppClientId": "<appclientid>",
          "Region": "<region>",
          "PinpointAppId": "<pinpointappid>"
     }
  }
  ```

- Manually recording events using the `record(event:)` API.

  If you don't want to use Cognito user pools, you can use the Pinpoint client to record and submit authentication events, as shown in the following examples. In these examples, the event type is set to `_userauth.sign_in`, but you can substitute any authentication event type.

  ```swift
  func sendUserSignInEvent() {
      let event = BasicAnalyticsEvent(
          name: "_userauth.sign_in"
      )
      Amplify.Analytics.record(event: event)
  }
  ```

## Global Properties

You can register properties which will be included across all `Amplify.Analytics.record(event:)` calls.

```swift
let globalProperties: AnalyticsProperties = [
    "globalPropertyKey": "value"
]
Amplify.Analytics.registerGlobalProperties(globalProperties)
```

To unregister global properties, call `Amplify.Analytics.unregisterGlobalProperties()`:

```swift
// When called with no arguments, it unregisters all global properties
Amplify.Analytics.unregisterGlobalProperties()

// Or you can specify which properties to unregister
let globalProperties = ["globalPropertyKey1", "globalPropertyKey2"]
Amplify.Analytics.unregisterGlobalProperties(globalProperties)
```
