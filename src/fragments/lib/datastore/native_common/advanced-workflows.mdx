## Custom Primary Keys

By default, all DataStore models have an `id` field by default that is automatically populated on the client with a UUID v4, allowing DataStore to generate non-colliding globally unique identifiers in a scalable way.

While UUIDs have desirable properties (they are large, non-sequential and opaque), there are times when a custom primary key is needed. For instance, to:

- Have friendly/readable identifiers (surrogate/opaque vs. natural keys)
- Define composite primary keys
- Customize data partitioning to optimize for scale (especially important when planning to handle large amounts of data in short periods of time)
- Selectively synchronize data to clients (e.g. by fields like `deviceId`, `userId` or similar)
- Prioritize the sort order in which objects are returned by the sync queries
- Make existing data consumable and syncable by DataStore

### Example schemas using custom primary keys

A schema with the typical `id` field looks like this:

```graphql
type Book @model {
  id: ID!
  title: String!
  description: String
}
```

With custom primary keys, you can provide a unique field name and/or value using the `@primaryKey` directive:

<BlockSwitcher>
<Block name="Custom Primary Key">

```graphql
type Book @model {
  isbn: ID! @primaryKey
  title: String!
  description: String
}
```

</Block>
<Block name="Composite Key">

```graphql
type Book @model {
  isbn: ID! @primaryKey(sortKeyFields: ["title"])
  title: String!
  description: String
}
```

</Block>
</BlockSwitcher>

### Creating records with Custom Primary Keys:

The following table explains when a value for the custom primary key must be provided:

<table>
  <tbody>
    <tr>
      <th>Description</th>
      <th>Type</th>
      <th>Autopopulated with UUID</th>
    </tr>
    <tr>
      <td>Without @primaryKey</td>
      <td>TODO: render type in td</td>
      <td>✅ Yes</td>
    </tr>
    <tr>
      <td>Without @primaryKey, explicit `id` field</td>
      <td>TODO: render type in td</td>
      <td>✅ Yes</td>
    </tr>
    <tr>
      <td>@primaryKey on a custom field</td>
      <td>TODO: render type in td</td>
      <td>❌ No</td>
    </tr>
    <tr>
      <td>Explicit @primaryKey on `id` field</td>
      <td>TODO: render type in td</td>
      <td>If not provided in constructor/builder</td>
    </tr>
    <tr>
      <td>Explicit @primaryKey on `id` field with sort key</td>
      <td>TODO: render type in td</td>
      <td>If not provided in constructor/builder</td>
    </tr>
    <tr>
      <td>Explicit `id` field in sort key</td>
      <td>TODO: render type in td</td>
      <td>If not provided in constructor/builder</td>
    </tr>
    <tr>
      <td>@primaryKey with no `id` field</td>
      <td>TODO: render type in td</td>
      <td>❌ No</td>
    </tr>
  </tbody>
</table>

### Querying records with Custom Primary Keys:

import android0 from '/src/fragments/lib/datastore/android/advanced-workflows/custom-primary-key/query-snippet.mdx';

<Fragments fragments={{ android: android0 }} />

import flutter0 from '/src/fragments/lib/datastore/flutter/advanced-workflows/custom-primary-key/query-snippet.mdx';

<Fragments fragments={{ flutter: flutter0 }} />

import ios0 from '/src/fragments/lib/datastore/ios/advanced-workflows/custom-primary-key/query-snippet.mdx';

<Fragments fragments={{ ios: ios0 }} />

import js0 from '/src/fragments/lib/datastore/js/advanced-workflows/custom-primary-key/query-snippet.mdx';

<Fragments fragments={{ js: js0 }} />

import android1 from '/src/fragments/lib/datastore/android/advanced-workflows/custom-primary-key/delete-snippet.mdx';

<Fragments fragments={{ android: android1 }} />

import ios1 from '/src/fragments/lib/datastore/ios/advanced-workflows/custom-primary-key/delete-snippet.mdx';

<Fragments fragments={{ ios: ios1 }} />

import js1 from '/src/fragments/lib/datastore/js/advanced-workflows/custom-primary-key/delete-snippet.mdx';

<Fragments fragments={{ js: js1 }} />

### Relational Models with Custom Primary Key

For more details on using custom primary keys with relational models, visit our [cli docs](https://docs.amplify.aws/cli/graphql/data-modeling/#relational-models-with-custom-primary-keys).
